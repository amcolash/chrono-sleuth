var t=Object.defineProperty,e=(e,i,n)=>(((e,i,n)=>{i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n})(e,"symbol"!=typeof i?i+"":i,n),n);import{p as i,g as n,c as r,a as s}from"./phaser-pZmLa9DQ.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const o={},a={width:1280,height:720},l={width:960,height:540};let h=!1,c=!1;c=!0;const{width:p,height:u}=a;h=!1,c=!1;const d={debug:!1,width:p,height:u,cameraOffset:u/3,zoomed:!1,dayMinutes:.25,rewindEnabled:!1,fastMode:!1};class y extends i.Scene{constructor(){super("Boot")}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png"),this.load.image("splash","splash.png")}create(){this.scene.start("Preloader")}}var f=(t=>(t[t.Backgrounds=-1]="Backgrounds",t[t.Warpers=0]="Warpers",t[t.Npcs=1]="Npcs",t[t.Items=2]="Items",t[t.Player=3]="Player",t[t.Shader=4]="Shader",t[t.Ui=5]="Ui",t[t.Ui2=6]="Ui2",t[t.Debug=7]="Debug",t[t.Overlay=8]="Overlay",t))(f||{});class g extends i.GameObjects.GameObject{constructor(t,i,n,r,s,o){super(t,"Light"),e(this,"x"),e(this,"y"),e(this,"light"),e(this,"debug"),t.add.existing(this),this.light=t.lights.addLight(i,n,r,s,o),this.debug=t.add.graphics({x:i,y:n}).setDepth(f.Debug),this.debug.lineStyle(3,65280),this.x=i,this.y=n,d.debug&&this.debug.strokeCircle(0,0,r)}setPosition(t,e){this.debug.setVisible(this.light.visible),this.light.setPosition(t,e),this.debug.setPosition(t,e),this.x=t,this.y=e}destroy(t){var e,i;super.destroy(t),this.debug.destroy(),null==(i=null==(e=this.scene)?void 0:e.lights)||i.removeLight(this.light)}}var m=(t=>(t[t.None=0]="None",t[t.Teleported=1]="Teleported",t[t.Talked=2]="Talked",t[t.Item=3]="Item",t[t.Prop=4]="Prop",t))(m||{}),b=(t=>(t[t.Underground=0]="Underground",t[t.Town=1]="Town",t[t.TownEast=2]="TownEast",t[t.Forest=3]="Forest",t[t.ForestEast=4]="ForestEast",t[t.Lake=5]="Lake",t[t.LakeEast=6]="LakeEast",t[t.TownNorth=7]="TownNorth",t[t.ClockSquare=8]="ClockSquare",t[t.ClockSquareNorth=9]="ClockSquareNorth",t[t.ClockEntrance=10]="ClockEntrance",t[t.ClockStairs=11]="ClockStairs",t[t.ClockTop=12]="ClockTop",t[t.TownWest=13]="TownWest",t[t.MansionOutside=14]="MansionOutside",t[t.MansionEntrance=15]="MansionEntrance",t[t.MansionExit=16]="MansionExit",t[t.LabEntrance=17]="LabEntrance",t[t.LabExit=18]="LabExit",t))(b||{}),v=(t=>(t[t.Wrench=0]="Wrench",t[t.Gear1=1]="Gear1",t[t.Gear2=2]="Gear2",t[t.Key=3]="Key",t[t.HerbRed=4]="HerbRed",t[t.HerbGreen=5]="HerbGreen",t[t.HerbBlue=6]="HerbBlue",t[t.Potion=7]="Potion",t))(v||{}),w=(t=>(t[t.ForestGear=0]="ForestGear",t[t.SphinxRiddle=1]="SphinxRiddle",t[t.InvestigateTownWest=2]="InvestigateTownWest",t[t.ExploreLab=3]="ExploreLab",t))(w||{}),x=(t=>(t[t.Inventor=0]="Inventor",t[t.Stranger=1]="Stranger",t[t.Sphinx=2]="Sphinx",t[t.Mayor=3]="Mayor",t[t.ClockTower=4]="ClockTower",t))(x||{}),S=(t=>(t[t.Sphinx=0]="Sphinx",t))(S||{}),k=(t=>(t[t.FixTheClock=0]="FixTheClock",t[t.ForestMazeSolved=1]="ForestMazeSolved",t[t.SphinxRiddleSolved=2]="SphinxRiddleSolved",t[t.MetTheMayor=3]="MetTheMayor",t[t.ClockFirstGear=4]="ClockFirstGear",t[t.AlchemyLabFound=5]="AlchemyLabFound",t[t.AlchemySetFixed=6]="AlchemySetFixed",t[t.SafeDiscovered=7]="SafeDiscovered",t[t.ExtraPotionInformation=8]="ExtraPotionInformation",t[t.ClockSecondGear=9]="ClockSecondGear",t))(k||{}),j=(t=>(t[t.LabHatch=0]="LabHatch",t[t.LabBook=1]="LabBook",t[t.AlchemySet=2]="AlchemySet",t[t.LabBookshelf1=3]="LabBookshelf1",t[t.LabBookshelf2=4]="LabBookshelf2",t[t.LabBookshelf3=5]="LabBookshelf3",t[t.LabPotionShelf1=6]="LabPotionShelf1",t[t.MansionPicture=7]="MansionPicture",t[t.MansionHole=8]="MansionHole",t))(j||{});const T={White:"fcfee9",Tan:"e6c99d",Peach:"d07151",Brown:"473946",Teal:"303646",Black:"1c1831",Warning:"993333",Lights:"ffccaa",Night:"335588",Background:"111111"};function I(t){return i.Display.Color.HexStringToColor(t).color}function O(t){return I(i.Display.Color.RGBToString(255*t.r,255*t.g,255*t.b))}const P={fontFamily:"m6x11, sans-serif",fontSize:24,color:`#${T.White}`};d.dayMinutes,i.GameObjects.Container;class A extends i.GameObjects.Text{constructor(t){super(t,d.width/2,d.height-50,"",P),this.setOrigin(.5).setBackgroundColor("#"+T.Black).setPadding(10,5).setAlign("center").setAlpha(.9).setScrollFactor(0).setDepth(f.Overlay).setVisible(!1),t.add.existing(this)}}var E=(t=>(t[t.Up=0]="Up",t[t.Down=1]="Down",t[t.Left=2]="Left",t[t.Right=3]="Right",t[t.Continue=4]="Continue",t[t.Back=5]="Back",t))(E||{});class C{constructor(t){e(this,"scene"),e(this,"keys",{0:!1,1:!1,2:!1,3:!1,4:!1,5:!1}),this.scene=t,this.listener(2,"LEFT"),this.listener(3,"RIGHT"),this.listener(0,"UP"),this.listener(1,"DOWN"),this.listener(0,"W"),this.listener(2,"A"),this.listener(1,"S"),this.listener(3,"D"),this.listener(4,"SPACE"),this.listener(4,"ENTER"),this.listener(5,"BACKSPACE")}listener(t,e){var i,n;null==(i=this.scene.input.keyboard)||i.on(`keydown-${e}`,(()=>this.keys[t]=!0)),null==(n=this.scene.input.keyboard)||n.on(`keyup-${e}`,(()=>this.keys[t]=!1))}resetKeys(){this.keys[0]=!1,this.keys[1]=!1,this.keys[2]=!1,this.keys[3]=!1,this.keys[4]=!1,this.keys[5]=!1}}const M=[{question:"I speak without a mouth and hear without ears. I have no body, but I come alive with the wind.",answer:"echo",options:["echo","whisper","ghost","silence","shadow"],hints:{[x.Inventor]:["The sphinx is known for asking about things we take for granted.","Think about what we hear in canyons."],[x.Stranger]:["The sphinx’s riddles are always a bit tricky.","I think this one is about something that bounces off walls."]}},{question:"I have cities, but no houses. I have mountains, but no trees. I have water, but no fish. What am I?",answer:"map",options:["map","globe","dream","photograph","landscape"],hints:{[x.Inventor]:["Think of something that represents the world, showing cities and mountains but not in a literal way."],[x.Stranger]:["Imagine something that can fit in your hand or hang on a wall, showing vast landscapes and bodies of water, but not in their true form."]}},{question:"I fly without wings. I cry without eyes. Whenever I go, darkness flies. What am I?",answer:"cloud",options:["cloud","bat","wind","shadow","storm"],hints:{[x.Inventor]:["The sphinx’s riddles can be twisted. Think about things that move or change without the usual parts, like wings or eyes."],[x.Stranger]:["Look at your surroundings. Shadows often behave in strange ways, don’t they?","They move, disappear, and seem to fly without wings."]}}];function z(t){return t instanceof Al?dt(t)%M.length:0}function L(t,e){const i=z(t);return M[i].hints[e]}const B=function(t){const e=i.Display.Color.ColorToRGBA(t);return new i.Display.Color(e.r,e.g,e.b,e.a)}(I(T.Background));function F(t,e,i){t.cameras.main.fadeIn(e,B.red,B.green,B.blue,((t,e)=>{e>=1&&i&&i()}))}function D(t,e,i){t.cameras.main.fadeOut(e,B.red,B.green,B.blue,((t,e)=>{e>=1&&i&&i()}))}function W(t,e,n){return!!(e.inventory.initialized&&e.quests.initialized&&e.journal.initialized)&&i.Math.Distance.BetweenPointsSquared(t,e)<(n||1e3)**2}function R(t,e,i){t.gamepad.setAlpha(0),t.scene.pause(),t.scene.launch(e,{player:t.player,...i})}const G={[j.LabHatch]:{x:-1910,y:640},[j.LabBook]:{x:300,y:1630,image:"book"},[j.AlchemySet]:{x:-1650,y:1600,image:"alchemy_empty",skipLighting:!0,particles:{scale:{min:.05,max:.15},speed:{min:30,max:120},alpha:{values:[0,.5,0]},gravityY:100,lifespan:{min:250,max:500},emitting:!1,stopAfter:60}},[j.LabBookshelf1]:{x:-1025,y:1700},[j.LabBookshelf2]:{x:-290,y:1700},[j.LabBookshelf3]:{x:-115,y:1700},[j.LabPotionShelf1]:{x:-790,y:1700},[j.MansionPicture]:{x:-1233,y:-580,scale:1.2,angle:5,image:"picture",origin:{x:0,y:0},initializeOnStart:!0},[j.MansionHole]:{x:-1870,y:-490}},U={[x.Inventor]:[{messages:["There are rumors of an abandoned mansion west of the town.","Some say it is haunted and dark magic lurks within."],conditions:{activeQuest:w.InvestigateTownWest}},{messages:["I see you found the first gear. You should talk to the mayor to learn more about the old clock."],conditions:{hasItem:v.Gear1},onCompleted:t=>{t.quests.updateExistingQuest(w.ForestGear,!0)}},{messages:t=>L(t.scene,x.Inventor),conditions:{activeQuest:w.SphinxRiddle}},{messages:["Now that you have the wrench, you can fix the clock tower. You’ll need three gears to do it."],conditions:{hasItem:v.Wrench}},{messages:["The clock tower is the heart of our town, but it’s been broken for ages. I’ve got a wrench, but you’ll need three special gears to fix it.","You might find the others by helping the townsfolk."],onCompleted:t=>{t.journal.addEntry(k.FixTheClock),t.inventory.addItem({type:v.Wrench,used:!1})}}],[x.Stranger]:[{messages:["The lock on that safe is no ordinary lock. It requires something special to open it."],conditions:{journalEntry:k.SafeDiscovered}},{messages:["Hmm a potion, I wonder what it does.","The alchemist was no ordinary person and built magical safeguards against intruders."],conditions:{hasItem:v.Potion}},{messages:["You heard of the mansion to the west? It was abandoned many years ago.","There is a rumor of an alchemy lab hidden somewhere nearby, but I have been searching for years and have found not even a single potion."],conditions:{activeQuest:w.InvestigateTownWest}},{messages:["Now that you have the first gear, I would talk to the inventor."],conditions:{hasItem:v.Gear1}},{messages:t=>L(t.scene,x.Stranger),conditions:{activeQuest:w.SphinxRiddle}},{messages:["I’ve heard rumors of a gear hidden deep in the Enchanted Forest. Beware of the forest’s creatures and traps.","One time I thought I saw an ancient being, but it ran away."],conditions:{hasItem:v.Wrench},onCompleted:t=>{t.quests.addQuest({id:w.ForestGear,completed:!1})}},{messages:["Who am I?","Eventually, you will learn."]}],[x.Sphinx]:[{messages:t=>function(t){const e=z(t);return[M[e].question]}(t.scene),options:t=>function(t){const e=z(t),i=[...M[e].options].sort((()=>Math.random()-.5));return i.push("I don’t know"),i}(t.scene),conditions:{activeQuest:w.SphinxRiddle},onSelected:function(t,e,i){t===function(t){const e=z(t);return M[e].answer}(e.scene)?e.message.setDialog({messages:["That is correct. Well done, you may pass."],onCompleted:t=>{t.quests.updateExistingQuest(w.SphinxRiddle,!0),t.journal.addEntry(k.SphinxRiddleSolved)}},i):"I don’t know"===t?e.message.setDialog({messages:["Come back when you have an answer for me."]},i):e.message.setDialog({messages:["That is not correct. Do not return."]},i)}},{messages:["Welcome, brave soul. To pass, you must answer my riddle. You may only answer once. If you are unsure, you may speak to the townsfolk. Choose wisely."],onCompleted:t=>{t.quests.addQuest({id:w.SphinxRiddle,completed:!1})}}],[x.Mayor]:[{messages:["The minute hand on the clock is spinning again.","It looks like it’s missing two more gears.","The abandoned mansion west of the town might be a good place to look."],conditions:{journalEntry:k.ClockFirstGear},onCompleted:t=>{t.quests.addQuest({id:w.InvestigateTownWest,completed:!1})}},{messages:["Did you go into the clock tower yet?"],conditions:{journalEntry:k.MetTheMayor}},{messages:["Hello, traveler. I am the mayor of this town. The clock tower has been broken for years.","Ah, I see you have found an old gear. Maybe it could be used to help fix the clock tower."],onCompleted:t=>{t.journal.addEntry(k.MetTheMayor)}}],[x.ClockTower]:[{messages:["With two of the gears in place, the clocks hands are moving again."],conditions:{journalEntry:k.ClockSecondGear}},{messages:["Slowly, you align and tighten the second gear into place.","[CREAKING NOISE]","Now two of the hands of the clock are moving again."],conditions:{hasItem:v.Gear2},onCompleted:t=>{t.inventory.removeItem(v.Gear2),t.journal.addEntry(k.ClockSecondGear)}},{messages:["The clock is partially moving again, but it is still missing two gears."],conditions:{journalEntry:k.ClockFirstGear}},{messages:["This dusty clock tower hasn't told the correct time in many years. It appears to be missing some gears.","Let’s see what happens when we add the first gear. You tighten the gear into place.","[CREAKING NOISE]","The clock tower is starting to partially move again. It looks like it’s missing two more gears."],conditions:{hasItem:v.Gear1},onCompleted:t=>{t.inventory.removeItem(v.Gear1),t.journal.addEntry(k.ClockFirstGear)}}]},_={[v.Gear1]:[{messages:["Hmm, this gear looks like it belongs in the clock tower. I should ask the inventor about it."]}],[v.Gear2]:[{messages:["Finally! I found the second gear.","I should take this to the clock tower."],onCompleted:t=>{t.quests.updateExistingQuest(w.InvestigateTownWest,!0)}}]},N={[j.LabHatch]:[{messages:["Let me see if I can open this hatch.","tow, The rusty key fits!","[CREAKING NOISE]","Alright, let’s see what is down there!"],conditions:{hasItem:v.Key},onCompleted:(t,e)=>{null==e||e.destroy(),console.log(e),t.inventory.removeItem(v.Key),t.journal.addEntry(k.AlchemyLabFound)}},{messages:["The hatch is locked. I wonder if there is a key somewhere."]}],[j.LabBook]:[{messages:['How could I have missed this? The potion is called the "Keyless Exlixir".',"This must be the key to the safe."],conditions:{journalEntry:k.SafeDiscovered},onCompleted:t=>{t.journal.addEntry(k.ExtraPotionInformation)}},{messages:["I should speak to the mysterious stranger about this lab and the potion I brewed."],conditions:{hasItem:v.Potion}},{messages:["With the alchemy set fixed, I should be able to recreate the experiment.","I will need to find three ingredients according to this.","I need to find a red herb, a green herb, and a blue herb."],conditions:{journalEntry:k.AlchemySetFixed},onCompleted:t=>{const e=t.scene;e.interactiveObjects.add(new V(e,v.HerbRed,t)),e.interactiveObjects.add(new V(e,v.HerbGreen,t)),e.interactiveObjects.add(new V(e,v.HerbBlue,t))}},{messages:["Maybe I can find more information in the lab."],conditions:{activeQuest:w.ExploreLab}},{messages:["This lab journal contains notes about an ancient alchemy experiement.","According to the notes, the experiment was a failure, and the alchemist disappeared.","It does say that there might have been a problem with one of the ingredients.","Maybe I can find more information in the lab."],onCompleted:t=>{t.quests.addQuest({id:w.ExploreLab,completed:!1})}}],[j.AlchemySet]:[{messages:["There’s nothing more that I can do here."],conditions:{hasItem:v.Potion}},{messages:["Now we have all of the ingredients.","Now I should be able to recreate the experiment.","According to the book..."],conditions:{hasUsedItem:v.HerbBlue},onCompleted:function(t,e){const i=t.scene;t.inventory.removeItem(v.HerbBlue),t.active=!1,D(i,500,(()=>{i.time.delayedCall(700,(()=>{var n;null==e||e.setTexture("alchemy_full"),null==(n=null==e?void 0:e.particles)||n.setConfig({...G[j.AlchemySet].particles,tint:[6684791],x:30}).start(),F(i,1500,(()=>{t.message.setDialog({messages:["I have created the potion mentioned in the old journal.","I should bring it to the mysterious stranger to see if they know how to use it."],onCompleted:(t,e)=>{t.inventory.addItem({type:v.Potion,used:!1}),t.quests.updateExistingQuest(w.ExploreLab,!0),null==e||e.setTexture("alchemy_empty"),t.active=!0}},e,"player_portrait")}))}))}))}},{messages:["The Blue Plumed Frond is last."],conditions:{hasItem:v.HerbBlue,hasUsedItem:v.HerbRed},onCompleted:(t,e)=>{var i;t.inventory.removeItem(v.HerbBlue),null==e||e.setTexture("alchemy_blue"),null==(i=null==e?void 0:e.particles)||i.setConfig({...G[j.AlchemySet].particles,tint:[170],x:-5}).start()}},{messages:["The Crimson Starbloom comes next."],conditions:{hasItem:v.HerbRed,hasUsedItem:v.HerbGreen},onCompleted:(t,e)=>{var i;t.inventory.removeItem(v.HerbRed),null==e||e.setTexture("alchemy_red"),null==(i=null==e?void 0:e.particles)||i.setConfig({...G[j.AlchemySet].particles,tint:[11141120],x:-20}).start()}},{messages:["The Green Writhewood goes in first."],conditions:{hasItem:v.HerbGreen},onCompleted:(t,e)=>{var i;t.inventory.removeItem(v.HerbGreen),null==e||e.setTexture("alchemy_green"),null==(i=null==e?void 0:e.particles)||i.setConfig({...G[j.AlchemySet].particles,tint:[43520],x:-35}).start()}},{messages:["Maybe the journal has more information about using this alchemy set."],conditions:{journalEntry:k.AlchemySetFixed}},{messages:["This alchemy set looks like the one in the journal.","If I can figure out how the set connects together, I might be able to recreate the experiment."],conditions:{activeQuest:w.ExploreLab},onCompleted:t=>{const e=t.scene;R(e,"PipesDialog",{gamepadVisible:e.gamepad.visible})}},{messages:["I shouldn’t touch this without knowing what it does."]}],[j.LabBookshelf1]:[{messages:['[Secrets of the Silver Transmutation]\n"Silver, the mirror of the soul, can be yielded from common materials. Begin with a lead base, cleanse it with the tears of a willow, and chant thrice under a new moon. Such processes, though fraught with danger, promise immense reward. Meticulous preparation of the material is crucial."','"Among these pages lie safeguards against volatile spirits and the precise lunar phases essential for success. Here are protective circles and counter-spells to be used should spirits prove malevolent. This knowledge has been passed down and refined for safety."'],conditions:{activeQuest:w.ExploreLab}}],[j.LabBookshelf2]:[{messages:['[Whispering Woods: A Compendium]\n"The sentient trees of Eldergrove are not myths; their trunks groan with ancient wisdom. To engage them, perform the Ritual of Leaves, using moonlit water and rare herbs, along with whispered incantations passed down by forest guardians."','"Notes on the rare Blue Moonflower, whose petals glow ghostly and unlock forest languages, are also included. Its bloom is brief, and harvesting must be timed at midnight to retain its properties. The chapter concludes with a discussion on plant symbiosis with Eldertrees."'],conditions:{activeQuest:w.ExploreLab}}],[j.LabBookshelf3]:[{messages:['[The Essence of Fire: Ignite and Control]\n"Mastering fire requires strength of will and profound respect for its power. Here, summoning circles and incantations to call forth fire spirits are detailed. Each summoning demands a tribute of phoenix ash. The endeavor is perilous, as spirits may lash out if provoked."','"The tome also discusses methods to quell flames should they rise against the summoner. Included are the chant of suppression and a dousing mixture from elemental waters and frost-bitten herbs. These countermeasures are vital for maintaining control over summoned entities."'],conditions:{activeQuest:w.ExploreLab}}],[j.LabPotionShelf1]:[{messages:['Hm, this is an interesting collection. What’s this "Elixir of Luminescence"? Could light up some dark corners. And "Brew of Bravery"... might make me bold enough to face a dragon, or foolish enough to try. What about "Draught of the Depths"—sounds like it could show me treasures or drown me in visions. Better not risk it; these might just burn me to a crisp!'],conditions:{activeQuest:w.ExploreLab}}],[j.MansionPicture]:[{messages:["You pour the potion into the safe keyhole.","[CLUNK]","The safe clicks open.","Huh, what’s that?"],conditions:{journalEntry:k.ExtraPotionInformation},onCompleted:(t,e)=>{t.inventory.removeItem(v.Potion);const i=t.scene,n=new V(t.scene,v.Gear2,t);i.interactiveObjects.add(n),n.setPosition(null==e?void 0:e.x,(null==e?void 0:e.y)+20),n.disabled=!0,i.tweens.add({targets:n,x:(null==e?void 0:e.x)-10,y:(null==e?void 0:e.y)+120,duration:1e3,onComplete:()=>{n.disabled=!1},ease:"Bounce.easeOut"})}},{messages:["A sturdy looking safe was hidden behind the picture.","It looks like it requires a special key to open."],conditions:{journalEntry:k.SafeDiscovered}},{messages:["An abstract picture of blocks.","Wait a moment, something is behind this picture","[CREAK]"],onCompleted:t=>{t.journal.addEntry(k.SafeDiscovered)},conditions:{hasItem:v.Potion}},{messages:["An abstract picture of blocks."]}],[j.MansionHole]:[{messages:["Literally a hole in the wall."]}]};function H(t,e,i){for(const n of t){const{conditions:t}=n,r=[];if(void 0!==(null==t?void 0:t.hasItem)&&r.push(rt(e.inventory.inventory,t.hasItem)),void 0!==(null==t?void 0:t.hasUsedItem)&&r.push(st(e.inventory.inventory,t.hasUsedItem)),void 0!==(null==t?void 0:t.completedQuest)&&r.push(at(e.quests.quests,t.completedQuest)),void 0!==(null==t?void 0:t.activeQuest)&&r.push(ot(e.quests.quests,t.activeQuest)),void 0!==(null==t?void 0:t.journalEntry)&&r.push(lt(e.journal.journal,t.journalEntry)),(null==t?void 0:t.custom)&&r.push(t.custom(e,i)),null==t?void 0:t.invert){if(null==t?void 0:t.or){if(r.some((t=>!t)))return n}else if(r.every((t=>!t)))return n;return}if(null==t?void 0:t.or){if(r.some((t=>t)))return n}else if(r.every((t=>t)))return n}}const $={[v.Wrench]:{x:0,y:0,image:"wrench",name:"Old Wrench"},[v.Gear1]:{x:5120,y:915,image:"gear",name:"Shiny Gear"},[v.Key]:{x:-1750,y:-420,image:"key",name:"Rusty Key"},[v.HerbRed]:{x:-200,y:1730,image:"herb_red",name:"Blue Plumed Frond"},[v.HerbGreen]:{x:-260,y:1730,image:"herb_green",name:"Green Writhewood"},[v.HerbBlue]:{x:-320,y:1730,image:"herb_blue",name:"Crimson Starbloom"},[v.Potion]:{x:0,y:0,image:"potion",name:"Strange Potion"},[v.Gear2]:{x:0,y:0,image:"gear2",name:"Old Gear"}};class V extends i.Physics.Arcade.Image{constructor(t,i,n){const{x:r,y:s,image:o}=$[i];super(t,r,s,o),e(this,"itemType"),e(this,"player"),e(this,"particles"),e(this,"light"),e(this,"disabled",!1),e(this,"initialized",!1),this.itemType=i,this.player=n,this.setScale(.35).setDepth(f.Items),yt(this,$[i])}lazyInit(t){(t||!this.initialized&&W(this,this.player))&&(this.player.inventory.inventory.find((t=>t.type===this.itemType))?this.destroy():(this.scene.add.existing(this),this.scene.physics.add.existing(this),d.debug&&this.setInteractive({draggable:!0}),this.particles=this.scene.add.particles(this.x,this.y,"warp",{scale:{start:0,end:.9},alpha:{start:.8,end:0},delay:500,lifespan:1500,maxAliveParticles:1}),d.debug?this.light=new g(this.scene,this.x,this.y,this.displayHeight/150*150,16764074,2):this.light=this.scene.lights.addLight(this.x,this.y,this.displayHeight/150*150,16764074,2),this.initialized=!0))}onInteract(t){if(t[E.Continue]){this.player.inventory.addItem({type:this.itemType,used:!1}),this.destroy();const t=H(_[this.itemType]||[],this.player,this);return t&&this.player.message.setDialog(t,this,"player_portrait"),m.Item}return m.None}destroy(t){var e,i,n;null==(e=this.particles)||e.destroy(),this.light instanceof g?this.light.destroy():null==(n=null==(i=this.scene)?void 0:i.lights)||n.removeLight(this.light),super.destroy(t)}getButtonPrompt(){return[`Pick Up ${$[this.itemType].name}`,"Press [CONTINUE]"]}update(){var t;this.lazyInit(),null==(t=this.particles)||t.setPosition(this.x,this.y)}}const q=2*Math.PI;class K extends i.GameObjects.Graphics{constructor(t,i){super(t),e(this,"player"),e(this,"angle1",0),e(this,"angle2",1),e(this,"angle3",4),e(this,"update1",!1),e(this,"update2",!1),e(this,"update3",!1),t.add.existing(this),this.player=i,this.setPosition(842,-2107),this.setDepth(f.Npcs),this.updateHands()}update(t){this.update1&&(this.angle1=q*(t/6e4)*35),this.update2&&(this.angle2=q*(t/36e5)*35),this.update3&&(this.angle3=q*(t/432e5)*35),this.clear(),this.lineStyle(6,I(T.Night)),this.lineBetween(0,0,50*Math.cos(this.angle1),50*Math.sin(this.angle1)),this.lineBetween(0,0,40*Math.cos(this.angle2),40*Math.sin(this.angle2)),this.lineBetween(0,0,25*Math.cos(this.angle3),25*Math.sin(this.angle3)),this.lineStyle(4,I(T.Black));for(let e=0;e<12;e++){const t=q*(e/12),i=50*Math.cos(t),n=50*Math.sin(t);this.lineBetween(i,n,1.5*i,1.5*n)}}updateHands(){const t=this.player.journal.journal;lt(t,k.ClockFirstGear)&&(this.update1=!0),lt(t,k.ClockSecondGear)&&(this.update2=!0)}}class Q extends i.Physics.Arcade.Image{constructor(t,n,r){const{x:s,y:o,image:a}=mt[n];super(t,s,o,a),e(this,"npcType"),e(this,"player"),e(this,"light"),e(this,"particles"),e(this,"lastPos",new i.Math.Vector2),e(this,"clock"),e(this,"initialized",!1),this.npcType=n,this.player=r,this.setDepth(f.Npcs),"warp"===a&&this.setAlpha(0),yt(this,mt[n])}lazyInit(t){if(!t&&(this.initialized||!W(this,this.player)))return;this.scene.add.existing(this),this.scene.physics.add.existing(this),d.debug&&this.setInteractive({draggable:!0});const{x:e,y:i,light:n,particles:r,onCreate:s}=mt[this.npcType];d.debug?this.light=new g(this.scene,this.x,this.y,this.displayHeight/150*150,16764074,n||1):this.light=this.scene.lights.addLight(this.x,this.y,this.displayHeight/150*150,16764074,n||1),r&&(this.particles=this.scene.add.particles(e,i,"",r)),this.npcType===x.ClockTower&&(this.clock=new K(this.scene,this.player)),s&&s(this),this.initialized=!0}update(t,e){this.lazyInit(),!this.light||this.x===this.lastPos.x&&this.y===this.lastPos.y||this.light.setPosition(this.x,this.y),this.lastPos.set(this.x,this.y),this.clock&&this.clock.update(t)}onInteract(t){if(this.player.message.visible||Date.now()<this.player.message.interactionTimeout)return m.None;if(t[E.Continue]){const t=H(U[this.npcType],this.player,this);if(t){const e=mt[this.npcType].portrait.length>0;return this.player.message.setDialog(t,e?this:void 0),m.Talked}}return m.None}getButtonPrompt(){return this.npcType===x.ClockTower?["Inspect Clock Tower","Press [CONTINUE]"]:[`Talk to ${mt[this.npcType].name}`,"Press [CONTINUE]"]}}class Y extends i.Physics.Arcade.Image{constructor(t,i,n){const{x:r,y:s,image:o}=G[i];super(t,r,s,o||""),e(this,"propType"),e(this,"player"),e(this,"initialized",!1),e(this,"particles"),this.propType=i,this.player=n,this.setScale(o?.35:2).setDepth(f.Items),o||d.debug||this.setAlpha(0),yt(this,G[i])}lazyInit(t){if(!t&&(this.initialized||!W(this,this.player)))return;if(this.player.journal.journal.includes(k.AlchemyLabFound)&&this.propType===j.LabHatch)return void this.destroy();this.scene.add.existing(this),this.scene.physics.add.existing(this),d.debug&&this.setInteractive({draggable:!0});const e=G[this.propType].particles;e&&(this.particles=this.scene.add.particles(this.x,this.y,"warp",e).setDepth(f.Items)),this.initialized=!0}onInteract(t){if(this.player.message.visible||Date.now()<this.player.message.interactionTimeout)return m.None;if(t[E.Continue]){const t=H(N[this.propType]||[],this.player,this);if(t)return this.player.message.setDialog(t,this,G[this.propType].portrait||"player_portrait"),m.Prop}return m.None}getButtonPrompt(){return H(N[this.propType]||[],this.player,this)?[`Inspect ${j[this.propType]}`,"Press [CONTINUE]"]:""}update(){this.lazyInit()}}const X={[k.FixTheClock]:{description:"The inventor gave me a wrench to help fix the clock tower. I will also need three gears to repair it."},[k.ForestMazeSolved]:{description:"I finally got through the forest maze. Next time should be much easier."},[k.SphinxRiddleSolved]:{description:"I solved the sphinx’s riddle. Now I can pass through the forest.",warpAdd:b.ForestEast},[k.MetTheMayor]:{description:"I have met the mayor of the town. She told me about the old clock tower. I should see if I can use the gear I found to try and fix it.",warpAdd:b.ClockSquareNorth},[k.ClockFirstGear]:{description:"I found the first gear for the clock tower and placed it into the clock face. I still need two more gears to fix it."},[k.AlchemyLabFound]:{description:"I found a secret alchemy lab. I wonder what the previous alchemist was brewing up.",warpAdd:b.LabEntrance},[k.AlchemySetFixed]:{description:"With the alchemy set fixed, I can now attempt to create the brew mentioned in the old journal."},[k.SafeDiscovered]:{description:"I discovered a safe in the abandonded mansion. I wonder what secrets it holds."},[k.ExtraPotionInformation]:{description:'I found an extra journal entry with more information on the potion. It stated the name of the potion was the "Keyless Elixir". This potion must be the key to unlocking the safe.'},[k.ClockSecondGear]:{description:"I found the second gear for the clock tower inside a safe, which was located within the abandoned mansion. I still need one more gear to fix it."}},J={[w.ForestGear]:{description:"Find the gear in the forest",warpAdd:b.TownEast,warpComplete:b.TownNorth},[w.SphinxRiddle]:{description:"Solve the Sphinx riddle"},[w.InvestigateTownWest]:{description:"Investigate the west side of town",warpAdd:b.TownWest},[w.ExploreLab]:{description:"Explore the hidden alchemy lab"}};var Z=(t=>(t[t.Ladder=0]="Ladder",t[t.Warp=1]="Warp",t[t.Invisible=2]="Invisible",t[t.WarpHidden=3]="WarpHidden",t[t.InvisibleHidden=4]="InvisibleHidden",t))(Z||{});const tt={[b.Town]:{x:300,y:650,key:E.Down,warpTo:b.Underground,visual:0},[b.Underground]:{x:301,y:875,key:E.Up,warpTo:b.Town,visual:0},[b.TownEast]:{x:1720,y:650,key:E.Right,warpTo:b.Forest,visual:3},[b.Forest]:{x:2650,y:815,key:E.Left,warpTo:b.TownEast,visual:1},[b.TownNorth]:{x:775,y:650,key:E.Up,warpTo:b.ClockSquare,visual:3},[b.ClockSquare]:{x:610,y:-330,key:E.Left,warpTo:b.TownNorth,visual:1},[b.ClockSquareNorth]:{x:915,y:-330,key:E.Up,warpTo:b.ClockEntrance,visual:3},[b.ClockEntrance]:{x:690,y:-1320,range:15,key:E.Left,warpTo:b.ClockSquareNorth,visual:1,skipLighting:!0},[b.ClockStairs]:{x:910,y:-1400,range:20,key:E.Right,warpTo:b.ClockTop,visual:2},[b.ClockTop]:{x:780,y:-1970,range:10,key:E.Left,warpTo:b.ClockStairs,visual:2},[b.ForestEast]:{x:3590,y:815,key:E.Right,warpTo:b.Lake,visual:3},[b.Lake]:{x:4625,y:915,key:E.Left,warpTo:b.ForestEast,visual:1},[b.LakeEast]:{x:6121,y:760,key:E.Right,warpTo:b.Lake,visual:1},[b.TownWest]:{x:90,y:650,key:E.Left,warpTo:b.MansionOutside,visual:3},[b.MansionOutside]:{x:-620,y:640,key:E.Right,warpTo:b.TownWest,visual:1},[b.MansionEntrance]:{x:-1290,y:640,key:E.Up,warpTo:b.MansionExit,visual:1},[b.MansionExit]:{x:-1405,y:-420,key:E.Down,warpTo:b.MansionEntrance,visual:2},[b.LabEntrance]:{x:-1920,y:640,key:E.Down,warpTo:b.LabExit,visual:4},[b.LabExit]:{x:-380,y:1545,key:E.Right,warpTo:b.LabEntrance,visual:2,range:15,skipLighting:!0}},et=[];Object.values(J).forEach((t=>{t.warpAdd&&et.push(t.warpAdd),t.warpComplete&&et.push(t.warpComplete)})),Object.values(X).forEach((t=>{t.warpAdd&&et.push(t.warpAdd)}));class it extends i.Physics.Arcade.Image{constructor(t,i,n){const{x:r,y:s,visual:o,range:a}=tt[i];super(t,r,s,o===Z.Ladder?"ladder":"warp"),e(this,"warpType"),e(this,"player"),e(this,"particles1"),e(this,"particles2"),e(this,"graphics"),e(this,"range"),e(this,"initialized",!1),this.warpType=i,this.player=n,this.range=a||30,this.setScale(.6).setDepth(f.Warpers),o!==Z.Warp&&o!==Z.WarpHidden||(this.setScale(.6,1),this.setPosition(r,s-12)),d.debug||(o!==Z.WarpHidden&&o!==Z.InvisibleHidden||this.setVisible(!1),o!==Z.Invisible&&o!==Z.InvisibleHidden||this.setAlpha(0)),yt(this,tt[i]),et.includes(i)&&t.add.existing(this)}lazyInit(t){(t||!this.initialized&&W(this,this.player))&&(et.includes(this.warpType)||this.scene.add.existing(this),this.scene.physics.add.existing(this),this.createParticles(),this.createDebug(),this.hasExtendedBounds()&&this.body&&this.setBodySize(this.body.width*(this.range/30*4),this.body.height),this.setVisible(this.visible),this.warpType===b.Underground&&(this.scene.add.image(this.x,this.y-60,"ladder").setScale(.6).setDepth(f.Warpers).setPipeline("Light2D"),this.scene.add.image(this.x,this.y-105,"ladder").setScale(.6).setDepth(f.Warpers).setPipeline("Light2D")),this.initialized=!0)}createParticles(){const{visual:t,skipLighting:e}=tt[this.warpType];t!==Z.Warp&&t!==Z.WarpHidden||(this.particles1=this.scene.add.particles(this.x,this.y-12,"warp",{x:{min:-3,max:3},y:{min:-3,max:3},speed:{random:[-40,40]},scale:{min:.35,max:.5},alpha:{start:.2,end:0},angle:{min:0,max:360},color:[I(T.Teal),I(T.White),I(T.Tan)],colorEase:"Linear",radial:!0,blendMode:i.BlendModes.OVERLAY}).setScale(1,2).setDepth(f.Warpers),this.particles1.viewBounds=this.particles1.getBounds(30,500),this.particles2=this.scene.add.particles(this.x,this.y-12,"warp",{x:{min:-30,max:30},y:{min:-50,max:50},speed:{random:[-5,5]},scale:{min:.05,max:.15},alpha:{values:[0,.2,0]},angle:{min:0,max:360},lifespan:{min:1e3,max:1400},color:[I(T.Peach),I(T.White),I(T.Tan)],colorEase:"Linear",radial:!0,maxAliveParticles:20}).setDepth(f.Warpers),this.particles2.viewBounds=this.particles2.getBounds(30,500),e||(this.particles1.setPipeline("Light2D"),this.particles2.setPipeline("Light2D")))}createDebug(){if(d.debug&&(this.setInteractive({draggable:!0}),this.graphics=this.scene.add.graphics(),this.hasExtendedBounds())){this.graphics.lineStyle(2,16711935).setPosition(this.x,this.y);const t=this.body;this.graphics.lineBetween(-this.range,-t.halfHeight,-this.range,t.halfHeight),this.graphics.lineBetween(this.range,-t.halfHeight,this.range,t.halfHeight),this.graphics.strokeCircle(0,0,5)}}hasExtendedBounds(){const{visual:t,key:e}=tt[this.warpType];return!(t!==Z.Warp&&t!==Z.WarpHidden&&t!==Z.Invisible||e!==E.Left&&e!==E.Right)}onInteract(t){const e=!this.hasExtendedBounds()||Math.abs(this.player.x-this.x)<this.range,i=t[tt[this.warpType].key]&&e;return!i||this.warpType!==b.TownEast||lt(this.player.journal.journal,k.ForestMazeSolved)||d.debug?i?(nt(tt[this.warpType].warpTo,this.player),m.Teleported):m.None:(R(this.scene,"MazeDialog"),m.None)}getButtonPrompt(){const t=tt[this.warpType].key;let e;return t===E.Continue&&(e="[CONTINUE]"),t===E.Up&&(e="[Up]"),t===E.Down&&(e="[Down]"),t===E.Left&&(e="[Left]"),t===E.Right&&(e="[Right]"),[`Travel to ${b[tt[this.warpType].warpTo]}`,"Press "+e]}setPosition(t,e,i,n){return super.setPosition(t,e,i,n),this.particles1&&this.particles2&&(this.particles1.setPosition(t,(e||0)-12),this.particles2.setPosition(t,(e||0)-12)),this.graphics&&this.graphics.setPosition(t,e),this}setVisible(t){return super.setVisible(t),this.particles1&&this.particles2&&(t?(this.particles1.start(),this.particles2.start()):(this.particles1.stop(),this.particles1.killAll(),this.particles2.stop(),this.particles2.killAll())),this}update(t,e){this.lazyInit()}destroy(t){this.particles1&&this.particles2&&(this.particles1.destroy(),this.particles2.destroy()),super.destroy(t)}}function nt(t,e){const{x:n,y:r,onWarp:s}=tt[t],o=e.scene,a=n-o.cameras.main.width/2,l=r-o.cameras.main.height/2;s&&s(e),o.cameras.main.fadeOut(200,0,0,0,((t,e)=>{e>=1&&o.cameras.main.fadeIn(1e3,0,0,0)})),o.cameras.main.stopFollow(),o.tweens.add({targets:o.cameras.main,scrollX:a,scrollY:l-d.cameraOffset,duration:600,delay:100,ease:"Power1",onComplete:()=>{o.cameras.main.startFollow(e),o.cameras.main.setFollowOffset(0,d.cameraOffset)}}),e.setActive(!1),o.tweens.add({targets:e,alpha:0,duration:500,ease:"Power1",yoyo:!0,repeat:0,onYoyo:()=>{e.setPosition(n,r)},onComplete:()=>{e.alpha=1,e.setActive(!0)}});const h=e.light instanceof i.GameObjects.Light?e.light:e.light.light;o.tweens.add({targets:h,x:n,y:r,duration:400,ease:"Power1"})}function rt(t,e){return void 0!==t.find((t=>t.type===e))}function st(t,e){return void 0!==t.find((t=>t.type===e&&t.used))}function ot(t,e){return t.some((t=>t.id===e&&!t.completed))}function at(t,e){return t.some((t=>t.id===e&&t.completed))}function lt(t,e){return t.includes(e)}function ht(t,e){return t.children.getAll().filter((t=>t instanceof e))}function ct(t,e,i){const n=function(t,e){return ht(t,it).find((t=>t.warpType===e))}(t,e);n&&n.setVisible(i)}function pt(t,e){return ht(t,Q).find((t=>t.npcType===e))}function ut(t,e){return ht(t,Y).find((t=>t.propType===e))}function dt(t){var e;return(null==(e=t.scene.get("Game").clock)?void 0:e.rewindCount)||0}function yt(t,e){const{scale:i,alpha:n,angle:r,depth:s,skipLighting:o,origin:a,initializeOnStart:l}=e;i&&t.setScale(i),n&&t.setAlpha(n),r&&t.setAngle(r),s&&t.setDepth(s),o||t.setPipeline("Light2D"),a&&t.setOrigin(a.x,a.y),l&&t.lazyInit(!0)}const ft=[{x:40,y:600},{x:1750,y:600},{x:90,y:820},{x:1650,y:820},{x:550,y:-400},{x:1150,y:-400},{x:640,y:-1380},{x:930,y:-1470},{x:740,y:-2050},{x:930,y:-2115},{x:2600,y:760},{x:3630,y:760,id:S.Sphinx},{x:4575,y:850},{x:6160,y:690},{x:-565,y:575},{x:-2075,y:575},{x:-1930,y:-480},{x:-1050,y:-510},{x:-2075,y:1630},{x:-350,y:1510},{x:270,y:1560}];function gt(t,e,n){var r,s;const o=pt(t,x.Sphinx);if(!o)return void console.error("Sphinx not found");const a=function(t,e){return ht(t,i.GameObjects.Rectangle).find((t=>t.getData("WallType")===e))}(t,S.Sphinx);a&&(e?a.setX((null==(r=ft.find((t=>t.id===S.Sphinx)))?void 0:r.x)||0):a.setX(a.x-150),null==(s=a.body)||s.updateFromGameObject());const{x:l,y:h}=mt[x.Sphinx],c=e?l+200:l,p=e?h-90:h;t.tweens.add({targets:o,alpha:0,duration:!e||n?0:300,ease:"Power1",yoyo:!0,repeat:0,onYoyo:()=>{o.setPosition(c,p)},onComplete:()=>{o.alpha=1}}),t.tweens.add({targets:o.light,x:c,y:p,duration:!e||n?0:450,ease:"Power1"})}const mt={[x.Inventor]:{x:550,y:635,scale:.75,image:"inventor",portrait:"inventor_portrait",name:"Johan the Inventor"},[x.Stranger]:{x:750,y:865,scale:1.35,image:"stranger",portrait:"stranger_portrait",name:"Mysterious Stranger"},[x.Sphinx]:{x:3520,y:790,scale:1,image:"sphinx",portrait:"sphinx_portrait",name:"Mystical Sphinx",onCreate:t=>gt(t.scene,!1,!0),light:1.85,initializeOnStart:!0},[x.Mayor]:{x:1065,y:-340,scale:.9,image:"mayor",portrait:"mayor_portrait",name:"Mayor of Town"},[x.ClockTower]:{x:880,y:-2090,scale:.5,image:"warp",portrait:"clock_portrait",name:"Clock Tower",particles:{texture:"warp",scale:{start:0,end:1.1},alpha:{start:1,end:0},lifespan:2e3,delay:1e3,maxAliveParticles:1,tint:[13067088]},onCreate:t=>{t.setOffset(150,-40)}}};class bt extends i.GameObjects.Text{constructor(t,i,n,r,s,o){super(t,i,n,r,{...P,fontSize:48,backgroundColor:`#${T.Teal}`,padding:{x:15,y:10},...o}),e(this,"onClick"),this.setOrigin(.5),t.add.existing(this),this.onClick=s,this.setInteractive({useHandCursor:!0}).setScrollFactor(0),this.on("pointerdown",(()=>s())),this.on("pointerover",(()=>this.setTint(12303291))),this.on("pointerout",(()=>this.setTint(16777215)))}}class vt extends i.GameObjects.Container{constructor(t){var i,n,r;super(t),e(this,"buttons",[]),e(this,"activeIndex",-1),t.add.existing(this).setScrollFactor(0),null==(i=t.input.keyboard)||i.on("keydown-UP",(()=>{this.setActiveButton(Math.max(0,this.activeIndex-1))})),null==(n=t.input.keyboard)||n.on("keydown-DOWN",(()=>{this.setActiveButton(Math.min(this.activeIndex+1,this.buttons.length-1))})),null==(r=t.input.keyboard)||r.on("keydown-ENTER",(()=>{var t;null==(t=this.buttons[this.activeIndex])||t.onClick()}))}addButton(t){this.add(t),this.buttons.push(t),1===this.buttons.length&&this.setActiveButton(0),t.on("pointerover",(()=>{this.setActiveButton(-1)}))}setActiveButton(t){var e,i;null==(e=this.buttons[this.activeIndex])||e.setTint(16777215),this.activeIndex=t,null==(i=this.buttons[this.activeIndex])||i.setTint(I(T.Tan))}clearButtons(){this.buttons=[],this.activeIndex=-1,this.removeAll(!0)}}const wt=20;class xt extends i.GameObjects.Container{constructor(t,i){var n,r;super(t),e(this,"textWidth"),e(this,"textHeight"),e(this,"player"),e(this,"target"),e(this,"npcName"),e(this,"text"),e(this,"box"),e(this,"portrait"),e(this,"options"),e(this,"optionsContainer"),e(this,"dialog"),e(this,"messageIndex"),e(this,"interactionTimeout"),e(this,"initialized",!1);const{width:s,height:o}=d;this.textWidth=s-135-80,this.textHeight=130,this.setScrollFactor(0),this.setPosition(wt,o-wt-170),this.setDepth(f.Overlay),this.setVisible(!1),this.player=i,null==(n=this.scene.input.keyboard)||n.on("keydown-ENTER",(()=>{this.options||this.updateDialog()})),null==(r=this.scene.input.keyboard)||r.on("keydown-BACKSPACE",(()=>{this.options||this.updateDialog()}))}createUI(){this.scene.add.existing(this),this.npcName=new i.GameObjects.Text(this.scene,170,15,"",{...P,color:"#"+T.Tan}),this.text=new i.GameObjects.Text(this.scene,170,60,"",P),this.text.width=this.textWidth,this.text.height=this.textHeight,this.text.setOrigin(0).setMaxLines(5),this.portrait=new i.GameObjects.Image(this.scene,wt,wt,"").setOrigin(0).setScale(1.5),this.box=new i.GameObjects.Rectangle(this.scene,0,0,d.width-40,170,I(T.Black),.8),this.box.setStrokeStyle(2,I(T.Tan),1),this.box.setOrigin(0,0),this.optionsContainer=new vt(this.scene).setDepth(f.Overlay),this.add([this.box,this.npcName,this.text,this.portrait])}setDialog(t,e,i){if(this.npcName||this.createUI(),this.setVisible(void 0!==t),this.target=e,this.messageIndex=0,this.dialog=t,this.interactionTimeout=Date.now()+350,this.scene.gamepad.offsetButtons(void 0!==this.dialog),!t)return;const n=i||(e instanceof Q?mt[e.npcType].portrait:void 0);this.npcName.setVisible(!1),n?(this.portrait.setVisible(!0),this.portrait.setTexture(n),this.text.setPosition(170,wt+(e instanceof Q?40:0)).setWordWrapWidth(this.textWidth,!0).setFixedSize(this.textWidth,this.textHeight),e instanceof Q&&(this.npcName.setVisible(!0),this.npcName.setText(mt[e.npcType].name))):(this.portrait.setVisible(!1),this.text.setPosition(wt,wt).setWordWrapWidth(170+this.textWidth,!0).setFixedSize(170+this.textWidth,this.textHeight)),this.showMessage()}showMessage(){const t=this.getMessages(),e=t&&t[this.messageIndex];e&&(this.text.setText(e),this.text.getWrappedText().length>5&&console.error("Message too long!",e)),this.updateOptions()}updateOptions(){if(this.optionsContainer.clearButtons(),this.options=this.getOptions(),!this.options)return;const t=!d.zoomed;this.options.forEach(((e,i)=>{const n=new bt(this.scene,d.width/2,d.height/(t?9:14)+i*(30+d.height/(t?16:22)),e,(()=>this.onSelectOption(e)),{fontSize:24,backgroundColor:"#"+T.Black,padding:{y:10},align:"center",fixedWidth:350}).setOrigin(.5).setDepth(f.Overlay);this.optionsContainer.addButton(n)}))}onSelectOption(t){var e;(null==(e=this.dialog)?void 0:e.onSelected)&&(this.dialog.onSelected(t,this.player,this.target),this.optionsContainer.removeAll(!0))}updateDialog(){if(Date.now()<this.interactionTimeout)return;const t=this.getMessages();this.dialog&&t&&(this.messageIndex++,this.messageIndex>=t.length?(this.dialog.onCompleted&&this.dialog.onCompleted(this.player,this.target),this.dialog=void 0,this.setVisible(!1)):this.showMessage(),this.scene.gamepad.offsetButtons(void 0!==this.dialog),this.interactionTimeout=Date.now()+350)}getMessages(){var t;let e=null==(t=this.dialog)?void 0:t.messages;return"function"==typeof e&&(e=e(this.player)),e}getOptions(){var t;let e=null==(t=this.dialog)?void 0:t.options;return"function"==typeof e&&(e=e(this.player)),e}}class St extends i.GameObjects.Text{constructor(t,e,i=3500,n=T.Teal){const r=ht(t,St).reduce(((t,e)=>Math.max(t,e.y-20)),0)+65;super(t,20,r,e,{...P,backgroundColor:"#"+n,padding:{x:10,y:5}}),this.setAlpha(0).setDepth(f.Overlay).setScrollFactor(0),t.add.existing(this),t.add.tween({targets:this,alpha:1,scale:1.05,y:r+10,duration:350,hold:i,yoyo:!0,repeat:0,onComplete:()=>this.destroy()})}}class kt extends i.GameObjects.Container{constructor(t){super(t,0,0),e(this,"inventory",[]),e(this,"text"),e(this,"rect"),e(this,"initialized",!1),this.setScrollFactor(0).setDepth(f.Ui).setVisible(!1)}createUI(){this.initialized||(this.scene.add.existing(this),this.rect=this.scene.add.rectangle(0,0,0,0,I(T.Teal)).setStrokeStyle(2,I(T.White)).setAlpha(.75).setOrigin(0),this.add(this.rect),this.text=this.scene.add.text(10,4,"Inventory",{...P,fontSize:32}),this.add(this.text),this.initialized=!0)}addItem(t,e){if(this.initialized||this.createUI(),this.inventory.push(t),!t.used){const e=this.scene.add.image(0,0,$[t.type].image).setScale(.35);t.type===v.Key&&e.setAngle(45),this.add(e)}this.updateItems();const i=function(t,e){return ht(t,V).find((t=>t.itemType===e))}(this.scene,t.type);null==i||i.destroy(),e||new St(this.scene,`New item added: ${$[t.type].name}`)}removeItem(t){var e;this.initialized||this.createUI();const i=this.inventory.find((e=>e.type===t));i&&(i.used=!0,null==(e=this.getAll().find((e=>{var i;return(null==(i=e.texture)?void 0:i.key)===$[t].image})))||e.destroy()),this.updateItems()}updateItems(){var t;this.initialized||this.createUI();let e=0;this.getAll().forEach((t=>{if(t instanceof i.GameObjects.Image){const i=32+50*e;t.setPosition(i,68),e++}})),this.setVisible(this.inventory.length>0);const n=Math.max((null==(t=this.text)?void 0:t.displayWidth)+18,50*e+12);this.setPosition(d.width-n-20,20),this.rect.setSize(n,102)}}class jt extends i.GameObjects.Image{constructor(t,i){super(t,d.width-50,d.height-55,"journal"),e(this,"player"),e(this,"journal",[]),e(this,"unread"),e(this,"initialized",!1),this.player=i}createUI(){var t;this.initialized||(this.setScrollFactor(0).setDepth(f.Ui).setScale(.5).setAlpha(0).setInteractive({useHandCursor:!0}).setActive(!1),this.on("pointerdown",this.openJournal),this.scene.add.existing(this),this.unread=this.scene.add.ellipse(d.width-21,d.height-89,20,20,11141120).setStrokeStyle(2,I(T.Black)).setScrollFactor(0).setDepth(f.Ui2).setVisible(!1),null==(t=this.scene.input.keyboard)||t.on("keydown-J",(()=>{this.openJournal()})),this.initialized=!0)}addEntry(t,e){this.initialized||this.createUI(),this.journal.includes(t)||(0===this.journal.length&&(this.scene.tweens.add({targets:this,alpha:1,duration:300}),this.setActive(!0)),this.journal.push(t),e||(this.unread.setVisible(!0),new St(this.scene,"New journal entry added!")),this.handleSideEffects(t,e||!1))}openJournal(){this.initialized||this.createUI(),0!==this.journal.length&&R(this.scene,"JournalDialog")}handleSideEffects(t,e){const{warpAdd:i}=X[t];if(i&&ct(this.scene,i,!0),t===k.SphinxRiddleSolved&&gt(this.scene,!0,e),t===k.ClockFirstGear||t===k.ClockSecondGear){const t=pt(this.scene,x.ClockTower);(null==t?void 0:t.clock)&&t.clock.updateHands()}if(t===k.SafeDiscovered){const t=ut(this.scene,j.MansionPicture);null==t||t.scene.tweens.add({targets:t,angle:97,duration:1500})}}}class Tt extends i.GameObjects.Container{constructor(t){super(t,d.width-330-20,120),e(this,"quests",[]),e(this,"questRectangle"),e(this,"initialized",!1)}createUI(){if(this.initialized)return;this.scene.add.existing(this),this.setScrollFactor(0).setDepth(f.Ui).setVisible(!1),this.questRectangle=this.scene.add.rectangle(0,0,330,60,I(T.Teal)).setStrokeStyle(2,I(T.White)).setAlpha(.75).setOrigin(0),this.add(this.questRectangle);const t=this.scene.add.text(10,4,"Quests",{...P,fontSize:32});this.add(t),this.initialized=!0}addQuest(t,e){if(this.initialized||this.createUI(),this.quests.find((e=>e.id===t.id)))return;this.quests.push(t),this.add(this.scene.add.text(0,0,J[t.id].description,{...P,fontSize:20})),this.updateQuests();const{warpAdd:i,warpComplete:n}=J[t.id];i&&ct(this.scene,i,!0),t.completed&&n&&ct(this.scene,n,!0),e||new St(this.scene,`New quest added: ${J[t.id].description}`)}updateExistingQuest(t,e){this.initialized||this.createUI();const i=this.quests.find((e=>e.id===t));i&&(!i.completed&&e&&new St(this.scene,`Quest completed: ${J[i.id].description}`),i.completed=e);const{warpComplete:n}=J[t];n&&ct(this.scene,n,e),this.updateQuests()}updateQuests(){this.initialized||this.createUI();const t=this.quests.filter((t=>!t.completed));let e=1,n=0;this.getAll().forEach((r=>{if(r instanceof i.GameObjects.Text)if(t.find((t=>r.text===J[t.id].description))||"Quests"===r.text){if("Quests"!==r.text){const t=14+30*e;r.setPosition(10,t),e++,n=Math.max(n,r.width)}}else r.destroy()}));const r=n+20;this.setX(d.width-20-r),this.setY(this.scene.player.inventory.inventory.length>0?140:20),this.setVisible(t.length>0),this.questRectangle.setSize(r,50+30*t.length)}reset(){this.quests=[],this.updateQuests()}}const It=1.35*(d.fastMode?350:120),Ot=new i.Math.Vector2(400,650);class Pt extends i.Physics.Arcade.Sprite{constructor(t){var i;super(t,Ot.x,Ot.y,"character",0),e(this,"scene"),e(this,"keys"),e(this,"light"),e(this,"debug"),e(this,"buttonPrompt"),e(this,"interactive"),e(this,"interactionTimeout",0),e(this,"message"),e(this,"inventory"),e(this,"quests"),e(this,"journal"),e(this,"counter",0),e(this,"history",[]),e(this,"rewinding",!1),this.scene=t,t.add.existing(this),t.physics.add.existing(this),d.debug&&this.setInteractive(),this.setBodySize(48,70).setOffset(40,10).setOrigin(.5,.65).setDepth(f.Player).setScale(1.35).setPipeline("Light2D"),d.debug?(this.light=new g(t,this.x,this.y,200,16768443,1.2),this.debug=t.add.circle(this.x,this.y,3,16711935).setDepth(f.Debug)):this.light=t.lights.addLight(this.x,this.y,200,16768443,1.2),(i=this).anims.create({key:"walk",frames:i.anims.generateFrameNumbers("character",{start:0,end:5}),frameRate:4,repeat:-1}),i.anims.play("walk"),this.keys=new C(t),this.message=new xt(t,this),this.inventory=new kt(t),this.quests=new Tt(t),this.journal=new jt(t,this)}update(t,e){var i,n,r;d.debug&&(this.setTint(this.interactive?16755370:16777215),this.debug.setPosition(this.x,this.y));const s=this.interactive&&!this.message.visible&&(null==(n=null==(i=this.buttonPrompt)?void 0:i.text)?void 0:n.length)>0||!1;s&&!this.buttonPrompt&&(this.buttonPrompt=new A(this.scene)),null==(r=this.buttonPrompt)||r.setVisible(s),this.setVelocity(0),this.rewinding?this.counter+e>31.25?(this.rewind(),this.counter=0):this.counter+=e:this.checkInteraction()||this.message.visible||this.updateVelocity(),this.light.setPosition(this.x,this.y),function(t){var e;const i=(null==(e=t.body)?void 0:e.velocity.x)||0,n=i<0;Math.abs(i)>0?(t.anims.resume(),t.flipX=t.rewinding?!n:n):t.anims.pause(),t.setAngle(t.flipX?-5:5)}(this)}checkInteraction(){let t;return this.interactive&&Date.now()>this.interactionTimeout&&(t=this.interactive.onInteract(this.keys.keys),t!==m.None&&(this.interactionTimeout=Date.now()+(this.interactive.interactionTimeout||500),this.keys.resetKeys(),t===m.Teleported&&(this.interactive=void 0))),t}updateVelocity(){let t=It;const e=this.keys.keys;e[E.Left]&&this.setVelocityX(-t),e[E.Right]&&this.setVelocityX(t),d.debug&&!this.interactive&&(e[E.Up]&&this.setVelocityY(-t),e[E.Down]&&this.setVelocityY(t)),e[E.Left]&&e[E.Right]&&this.setVelocityX(0)}record(){var t;this.history.length<1e3?this.history.push(new i.Math.Vector3(this.x,this.y,(null==(t=this.body)?void 0:t.velocity.x)||0)):console.warn("Max history reached")}rewind(){const t=this.history.pop();t&&(this.x=t.x,this.y=t.y,this.setVelocityX(-t.z))}setRewind(t){this.rewinding=t,this.counter=0}reset(){this.quests.reset(),this.setPosition(Ot.x,Ot.y),this.flipX=!1,this.setVelocity(0)}setInteractiveObject(t){var e,i;this.interactive=t,(null==t?void 0:t.onCollided)&&t.onCollided();const n=null==(e=null==t?void 0:t.getButtonPrompt)?void 0:e.call(t);n&&!this.buttonPrompt&&(this.buttonPrompt=new A(this.scene)),null==(i=this.buttonPrompt)||i.setText(n)}}const At="chrono-sleuth-save";var Et=(t=>(t[t.New=0]="New",t[t.Act1=1]="Act1",t[t.Act2=2]="Act2",t))(Et||{});const Ct={gamepad:!1,debug:!1,zoomed:!0},Mt={0:{player:{x:Ot.x,y:Ot.y,flip:!1},journal:[],inventory:[],quests:[],settings:{gamepad:[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((t=>navigator.userAgent.match(t))),debug:!1,zoomed:!0}},1:{player:{x:Ot.x,y:Ot.y,flip:!1},journal:[k.FixTheClock,k.ForestMazeSolved,k.SphinxRiddleSolved],inventory:[{type:v.Wrench,used:!1},{type:v.Gear1,used:!1}],quests:[{id:w.ForestGear,completed:!1},{id:w.SphinxRiddle,completed:!0}],settings:{...Ct}},2:{player:{x:-770,y:Ot.y,flip:!0},journal:[k.FixTheClock,k.ForestMazeSolved,k.SphinxRiddleSolved,k.MetTheMayor,k.ClockFirstGear],inventory:[{type:v.Wrench,used:!1},{type:v.Gear1,used:!0}],quests:[{id:w.ForestGear,completed:!0},{id:w.SphinxRiddle,completed:!0},{id:w.InvestigateTownWest,completed:!1}],settings:{...Ct}}},zt=1200;let Lt=!1;function Bt(t){return O(t.lights.ambientColor)===I(T.White)}function Ft(t,e=!0){Lt||(Dt(t,T.White,e),t.lights.lights.forEach((i=>{const n=i.intensity;e?t.tweens.add({targets:i,duration:zt,intensity:0,onComplete:()=>{i.setVisible(!1),i.setIntensity(n)}}):i.setVisible(!1)})))}function Dt(t,e,n){if(!n)return void t.lights.setAmbientColor(I(e));Lt=!0;const r=O(t.lights.ambientColor),s=i.Display.Color.ValueToColor(r),o=i.Display.Color.ValueToColor(e);t.tweens.addCounter({from:0,to:100,duration:zt,onUpdate:e=>{const n=i.Display.Color.Interpolate.ColorWithColor(s,o,100,e.getValue());var r;t.lights.setAmbientColor((r=n,I(i.Display.Color.RGBToString(r.r,r.g,r.b))))},onComplete:()=>{Lt=!1}})}var Wt,Rt,Gt=Object.prototype.toString,Ut=function(t){var e=Gt.call(t),i="[object Arguments]"===e;return i||(i="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===Gt.call(t.callee)),i},_t=Array.prototype.slice,Nt=Ut,Ht=Object.keys,$t=Ht?function(t){return Ht(t)}:function(){if(Rt)return Wt;var t;if(Rt=1,!Object.keys){var e=Object.prototype.hasOwnProperty,i=Object.prototype.toString,n=Ut,r=Object.prototype.propertyIsEnumerable,s=!r.call({toString:null},"toString"),o=r.call((function(){}),"prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(t){var e=t.constructor;return e&&e.prototype===t},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},c=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!h["$"+t]&&e.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{l(window[t])}catch(i){return!0}}catch(i){return!0}return!1}();t=function(t){var r=null!==t&&"object"==typeof t,h="[object Function]"===i.call(t),p=n(t),u=r&&"[object String]"===i.call(t),d=[];if(!r&&!h&&!p)throw new TypeError("Object.keys called on a non-object");var y=o&&h;if(u&&t.length>0&&!e.call(t,0))for(var f=0;f<t.length;++f)d.push(String(f));if(p&&t.length>0)for(var g=0;g<t.length;++g)d.push(String(g));else for(var m in t)y&&"prototype"===m||!e.call(t,m)||d.push(String(m));if(s)for(var b=function(t){if("undefined"==typeof window||!c)return l(t);try{return l(t)}catch(e){return!1}}(t),v=0;v<a.length;++v)b&&"constructor"===a[v]||!e.call(t,a[v])||d.push(a[v]);return d}}return Wt=t}(),Vt=Object.keys;$t.shim=function(){if(Object.keys){var t=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);t||(Object.keys=function(t){return Nt(t)?Vt(_t.call(t)):Vt(t)})}else Object.keys=$t;return Object.keys||$t};var qt,Kt=$t,Qt=Error,Yt=EvalError,Xt=RangeError,Jt=ReferenceError,Zt=SyntaxError,te=TypeError,ee=URIError,ie=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),i=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var n=Object.getOwnPropertySymbols(t);if(1!==n.length||n[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0},ne="undefined"!=typeof Symbol&&Symbol,re=ie,se=function(){return"function"==typeof ne&&"function"==typeof Symbol&&"symbol"==typeof ne("foo")&&"symbol"==typeof Symbol("bar")&&re()},oe={__proto__:null,foo:{}},ae=Object,le=Object.prototype.toString,he=Math.max,ce=function(t,e){for(var i=[],n=0;n<t.length;n+=1)i[n]=t[n];for(var r=0;r<e.length;r+=1)i[r+t.length]=e[r];return i},pe=Function.prototype.bind||function(t){var e=this;if("function"!=typeof e||"[object Function]"!==le.apply(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var i,n=function(t,e){for(var i=[],n=1,r=0;n<t.length;n+=1,r+=1)i[r]=t[n];return i}(arguments),r=he(0,e.length-n.length),s=[],o=0;o<r;o++)s[o]="$"+o;if(i=Function("binder","return function ("+function(t,e){for(var i="",n=0;n<t.length;n+=1)i+=t[n],n+1<t.length&&(i+=",");return i}(s)+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof i){var r=e.apply(this,ce(n,arguments));return Object(r)===r?r:this}return e.apply(t,ce(n,arguments))})),e.prototype){var a=function(){};a.prototype=e.prototype,i.prototype=new a,a.prototype=null}return i},ue=Function.prototype.call,de=Object.prototype.hasOwnProperty,ye=pe.call(ue,de),fe=Qt,ge=Yt,me=Xt,be=Jt,ve=Zt,we=te,xe=ee,Se=Function,ke=function(t){try{return Se('"use strict"; return ('+t+").constructor;")()}catch(e){}},je=Object.getOwnPropertyDescriptor;if(je)try{je({},"")}catch(nh){je=null}var Te=function(){throw new we},Ie=je?function(){try{return Te}catch(t){try{return je(arguments,"callee").get}catch(e){return Te}}}():Te,Oe=se(),Pe={__proto__:oe}.foo===oe.foo&&!(oe instanceof ae),Ae=Object.getPrototypeOf||(Pe?function(t){return t.__proto__}:null),Ee={},Ce="undefined"!=typeof Uint8Array&&Ae?Ae(Uint8Array):qt,Me={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?qt:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?qt:ArrayBuffer,"%ArrayIteratorPrototype%":Oe&&Ae?Ae([][Symbol.iterator]()):qt,"%AsyncFromSyncIteratorPrototype%":qt,"%AsyncFunction%":Ee,"%AsyncGenerator%":Ee,"%AsyncGeneratorFunction%":Ee,"%AsyncIteratorPrototype%":Ee,"%Atomics%":"undefined"==typeof Atomics?qt:Atomics,"%BigInt%":"undefined"==typeof BigInt?qt:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?qt:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?qt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?qt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":fe,"%eval%":eval,"%EvalError%":ge,"%Float32Array%":"undefined"==typeof Float32Array?qt:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?qt:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?qt:FinalizationRegistry,"%Function%":Se,"%GeneratorFunction%":Ee,"%Int8Array%":"undefined"==typeof Int8Array?qt:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?qt:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?qt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Oe&&Ae?Ae(Ae([][Symbol.iterator]())):qt,"%JSON%":"object"==typeof JSON?JSON:qt,"%Map%":"undefined"==typeof Map?qt:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&Oe&&Ae?Ae((new Map)[Symbol.iterator]()):qt,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?qt:Promise,"%Proxy%":"undefined"==typeof Proxy?qt:Proxy,"%RangeError%":me,"%ReferenceError%":be,"%Reflect%":"undefined"==typeof Reflect?qt:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?qt:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&Oe&&Ae?Ae((new Set)[Symbol.iterator]()):qt,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?qt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Oe&&Ae?Ae(""[Symbol.iterator]()):qt,"%Symbol%":Oe?Symbol:qt,"%SyntaxError%":ve,"%ThrowTypeError%":Ie,"%TypedArray%":Ce,"%TypeError%":we,"%Uint8Array%":"undefined"==typeof Uint8Array?qt:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?qt:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?qt:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?qt:Uint32Array,"%URIError%":xe,"%WeakMap%":"undefined"==typeof WeakMap?qt:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?qt:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?qt:WeakSet};if(Ae)try{null.error}catch(nh){var ze=Ae(Ae(nh));Me["%Error.prototype%"]=ze}var Le=function t(e){var i;if("%AsyncFunction%"===e)i=ke("async function () {}");else if("%GeneratorFunction%"===e)i=ke("function* () {}");else if("%AsyncGeneratorFunction%"===e)i=ke("async function* () {}");else if("%AsyncGenerator%"===e){var n=t("%AsyncGeneratorFunction%");n&&(i=n.prototype)}else if("%AsyncIteratorPrototype%"===e){var r=t("%AsyncGenerator%");r&&Ae&&(i=Ae(r.prototype))}return Me[e]=i,i},Be={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Fe=pe,De=ye,We=Fe.call(Function.call,Array.prototype.concat),Re=Fe.call(Function.apply,Array.prototype.splice),Ge=Fe.call(Function.call,String.prototype.replace),Ue=Fe.call(Function.call,String.prototype.slice),_e=Fe.call(Function.call,RegExp.prototype.exec),Ne=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,He=/\\(\\)?/g,$e=function(t,e){var i,n=t;if(De(Be,n)&&(n="%"+(i=Be[n])[0]+"%"),De(Me,n)){var r=Me[n];if(r===Ee&&(r=Le(n)),void 0===r&&!e)throw new we("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:r}}throw new ve("intrinsic "+t+" does not exist!")},Ve=function(t,e){if("string"!=typeof t||0===t.length)throw new we("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new we('"allowMissing" argument must be a boolean');if(null===_e(/^%?[^%]*%?$/,t))throw new ve("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=function(t){var e=Ue(t,0,1),i=Ue(t,-1);if("%"===e&&"%"!==i)throw new ve("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==e)throw new ve("invalid intrinsic syntax, expected opening `%`");var n=[];return Ge(t,Ne,(function(t,e,i,r){n[n.length]=i?Ge(r,He,"$1"):e||t})),n}(t),n=i.length>0?i[0]:"",r=$e("%"+n+"%",e),s=r.name,o=r.value,a=!1,l=r.alias;l&&(n=l[0],Re(i,We([0,1],l)));for(var h=1,c=!0;h<i.length;h+=1){var p=i[h],u=Ue(p,0,1),d=Ue(p,-1);if(('"'===u||"'"===u||"`"===u||'"'===d||"'"===d||"`"===d)&&u!==d)throw new ve("property names with quotes must have matching quotes");if("constructor"!==p&&c||(a=!0),De(Me,s="%"+(n+="."+p)+"%"))o=Me[s];else if(null!=o){if(!(p in o)){if(!e)throw new we("base intrinsic for "+t+" exists, but the property is not available.");return}if(je&&h+1>=i.length){var y=je(o,p);o=(c=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:o[p]}else c=De(o,p),o=o[p];c&&!a&&(Me[s]=o)}}return o},qe=Ve("%Object.defineProperty%",!0)||!1;if(qe)try{qe({},"a",{value:1})}catch(nh){qe=!1}var Ke=qe,Qe=Ve("%Object.getOwnPropertyDescriptor%",!0);if(Qe)try{Qe([],"length")}catch(nh){Qe=null}var Ye=Qe,Xe=Ke,Je=Zt,Ze=te,ti=Ye,ei=function(t,e,i){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new Ze("`obj` must be an object or a function`");if("string"!=typeof e&&"symbol"!=typeof e)throw new Ze("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new Ze("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new Ze("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new Ze("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new Ze("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,r=arguments.length>4?arguments[4]:null,s=arguments.length>5?arguments[5]:null,o=arguments.length>6&&arguments[6],a=!!ti&&ti(t,e);if(Xe)Xe(t,e,{configurable:null===s&&a?a.configurable:!s,enumerable:null===n&&a?a.enumerable:!n,value:i,writable:null===r&&a?a.writable:!r});else{if(!o&&(n||r||s))throw new Je("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");t[e]=i}},ii=Ke,ni=function(){return!!ii};ni.hasArrayLengthDefineBug=function(){if(!ii)return null;try{return 1!==ii([],"length",{value:1}).length}catch(nh){return!0}};var ri=ni,si=Kt,oi="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),ai=Object.prototype.toString,li=Array.prototype.concat,hi=ei,ci=ri(),pi=function(t,e,i,n){if(e in t)if(!0===n){if(t[e]===i)return}else if("function"!=typeof(r=n)||"[object Function]"!==ai.call(r)||!n())return;var r;ci?hi(t,e,i,!0):hi(t,e,i)},ui=function(t,e){var i=arguments.length>2?arguments[2]:{},n=si(e);oi&&(n=li.call(n,Object.getOwnPropertySymbols(e)));for(var r=0;r<n.length;r+=1)pi(t,n[r],e[n[r]],i[n[r]])};ui.supportsDescriptors=!!ci;var di=ui,yi={exports:{}},fi=Ve,gi=ei,mi=ri(),bi=Ye,vi=te,wi=fi("%Math.floor%"),xi=function(t,e){if("function"!=typeof t)throw new vi("`fn` is not a function");if("number"!=typeof e||e<0||e>4294967295||wi(e)!==e)throw new vi("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],n=!0,r=!0;if("length"in t&&bi){var s=bi(t,"length");s&&!s.configurable&&(n=!1),s&&!s.writable&&(r=!1)}return(n||r||!i)&&(mi?gi(t,"length",e,!0,!0):gi(t,"length",e)),t};!function(t){var e=pe,i=Ve,n=xi,r=te,s=i("%Function.prototype.apply%"),o=i("%Function.prototype.call%"),a=i("%Reflect.apply%",!0)||e.call(o,s),l=Ke,h=i("%Math.max%");t.exports=function(t){if("function"!=typeof t)throw new r("a function is required");var i=a(e,o,arguments);return n(i,1+h(0,t.length-(arguments.length-1)),!0)};var c=function(){return a(e,s,arguments)};l?l(t.exports,"apply",{value:c}):t.exports.apply=c}(yi);var Si=yi.exports,ki=Ve,ji=Si,Ti=ji(ki("String.prototype.indexOf")),Ii=function(t,e){var i=ki(t,!!e);return"function"==typeof i&&Ti(t,".prototype.")>-1?ji(i):i},Oi=Kt,Pi=ie(),Ai=Ii,Ei=Object,Ci=Ai("Array.prototype.push"),Mi=Ai("Object.prototype.propertyIsEnumerable"),zi=Pi?Object.getOwnPropertySymbols:null,Li=function(t,e){if(null==t)throw new TypeError("target must be an object");var i=Ei(t);if(1===arguments.length)return i;for(var n=1;n<arguments.length;++n){var r=Ei(arguments[n]),s=Oi(r),o=Pi&&(Object.getOwnPropertySymbols||zi);if(o)for(var a=o(r),l=0;l<a.length;++l){var h=a[l];Mi(r,h)&&Ci(s,h)}for(var c=0;c<s.length;++c){var p=s[c];if(Mi(r,p)){var u=r[p];i[p]=u}}}return i},Bi=Li,Fi=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var t="abcdefghijklmnopqrst",e=t.split(""),i={},n=0;n<e.length;++n)i[e[n]]=e[n];var r=Object.assign({},i),s="";for(var o in r)s+=o;return t!==s}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var t=Object.preventExtensions({1:2});try{Object.assign(t,"xy")}catch(nh){return"y"===t[1]}return!1}()?Bi:Object.assign:Bi},Di=di,Wi=Fi,Ri=di,Gi=Li,Ui=Fi,_i=Si.apply(Ui()),Ni=function(t,e){return _i(Object,arguments)};Ri(Ni,{getPolyfill:Ui,implementation:Gi,shim:function(){var t=Wi();return Di(Object,{assign:t},{assign:function(){return Object.assign!==t}}),t}});var Hi=Ni,$i=function(){return"string"==typeof function(){}.name},Vi=Object.getOwnPropertyDescriptor;if(Vi)try{Vi([],"length")}catch(nh){Vi=null}$i.functionsHaveConfigurableNames=function(){if(!$i()||!Vi)return!1;var t=Vi((function(){}),"name");return!!t&&!!t.configurable};var qi=Function.prototype.bind;$i.boundFunctionsHaveNames=function(){return $i()&&"function"==typeof qi&&""!==function(){}.bind().name};var Ki=$i,Qi=ei,Yi=ri(),Xi=Ki.functionsHaveConfigurableNames(),Ji=te,Zi=te,tn=Object,en=function(t,e){if("function"!=typeof t)throw new Ji("`fn` is not a function");return arguments.length>2&&!!arguments[2]&&!Xi||(Yi?Qi(t,"name",e,!0,!0):Qi(t,"name",e)),t}((function(){if(null==this||this!==tn(this))throw new Zi("RegExp.prototype.flags getter called on non-object");var t="";return this.hasIndices&&(t+="d"),this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.unicodeSets&&(t+="v"),this.sticky&&(t+="y"),t}),"get flags",!0),nn=en,rn=di.supportsDescriptors,sn=Object.getOwnPropertyDescriptor,on=function(){if(rn&&"gim"===/a/gim.flags){var t=sn(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var e="",i={};if(Object.defineProperty(i,"hasIndices",{get:function(){e+="d"}}),Object.defineProperty(i,"sticky",{get:function(){e+="y"}}),"dy"===e)return t.get}}return nn},an=di.supportsDescriptors,ln=on,hn=Object.getOwnPropertyDescriptor,cn=Object.defineProperty,pn=TypeError,un=Object.getPrototypeOf,dn=/a/,yn=di,fn=en,gn=on,mn=Si(gn());yn(mn,{getPolyfill:gn,implementation:fn,shim:function(){if(!an||!un)throw new pn("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=ln(),e=un(dn),i=hn(e,"flags");return i&&i.get===t||cn(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}});var bn=mn,vn={exports:{}},wn=ie,xn=function(){return wn()&&!!Symbol.toStringTag},Sn=xn(),kn=Ii("Object.prototype.toString"),jn=function(t){return!(Sn&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===kn(t)},Tn=function(t){return!!jn(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==kn(t)&&"[object Function]"===kn(t.callee)},In=function(){return jn(arguments)}();jn.isLegacyArguments=Tn;var On=In?jn:Tn;const Pn=n(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var An="function"==typeof Map&&Map.prototype,En=Object.getOwnPropertyDescriptor&&An?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Cn=An&&En&&"function"==typeof En.get?En.get:null,Mn=An&&Map.prototype.forEach,zn="function"==typeof Set&&Set.prototype,Ln=Object.getOwnPropertyDescriptor&&zn?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Bn=zn&&Ln&&"function"==typeof Ln.get?Ln.get:null,Fn=zn&&Set.prototype.forEach,Dn="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,Wn="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,Rn="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Gn=Boolean.prototype.valueOf,Un=Object.prototype.toString,_n=Function.prototype.toString,Nn=String.prototype.match,Hn=String.prototype.slice,$n=String.prototype.replace,Vn=String.prototype.toUpperCase,qn=String.prototype.toLowerCase,Kn=RegExp.prototype.test,Qn=Array.prototype.concat,Yn=Array.prototype.join,Xn=Array.prototype.slice,Jn=Math.floor,Zn="function"==typeof BigInt?BigInt.prototype.valueOf:null,tr=Object.getOwnPropertySymbols,er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,ir="function"==typeof Symbol&&"object"==typeof Symbol.iterator,nr="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,rr=Object.prototype.propertyIsEnumerable,sr=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function or(t,e){if(t===1/0||t===-1/0||t!=t||t&&t>-1e3&&t<1e3||Kn.call(/e/,e))return e;var i=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var n=t<0?-Jn(-t):Jn(t);if(n!==t){var r=String(n),s=Hn.call(e,r.length+1);return $n.call(r,i,"$&_")+"."+$n.call($n.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return $n.call(e,i,"$&_")}var ar=Pn,lr=ar.custom,hr=yr(lr)?lr:null;function cr(t,e,i){var n="double"===(i.quoteStyle||e)?'"':"'";return n+t+n}function pr(t){return $n.call(String(t),/"/g,"&quot;")}function ur(t){return!("[object Array]"!==mr(t)||nr&&"object"==typeof t&&nr in t)}function dr(t){return!("[object RegExp]"!==mr(t)||nr&&"object"==typeof t&&nr in t)}function yr(t){if(ir)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return!0;if(!t||"object"!=typeof t||!er)return!1;try{return er.call(t),!0}catch(nh){}return!1}var fr=Object.prototype.hasOwnProperty||function(t){return t in this};function gr(t,e){return fr.call(t,e)}function mr(t){return Un.call(t)}function br(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}function vr(t,e){if(t.length>e.maxStringLength){var i=t.length-e.maxStringLength,n="... "+i+" more character"+(i>1?"s":"");return vr(Hn.call(t,0,e.maxStringLength),e)+n}return cr($n.call($n.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,wr),"single",e)}function wr(t){var e=t.charCodeAt(0),i={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return i?"\\"+i:"\\x"+(e<16?"0":"")+Vn.call(e.toString(16))}function xr(t){return"Object("+t+")"}function Sr(t){return t+" { ? }"}function kr(t,e,i,n){return t+" ("+e+") {"+(n?jr(i,n):Yn.call(i,", "))+"}"}function jr(t,e){if(0===t.length)return"";var i="\n"+e.prev+e.base;return i+Yn.call(t,","+i)+"\n"+e.prev}function Tr(t,e){var i=ur(t),n=[];if(i){n.length=t.length;for(var r=0;r<t.length;r++)n[r]=gr(t,r)?e(t[r],t):""}var s,o="function"==typeof tr?tr(t):[];if(ir){s={};for(var a=0;a<o.length;a++)s["$"+o[a]]=o[a]}for(var l in t)gr(t,l)&&(i&&String(Number(l))===l&&l<t.length||ir&&s["$"+l]instanceof Symbol||(Kn.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if("function"==typeof tr)for(var h=0;h<o.length;h++)rr.call(t,o[h])&&n.push("["+e(o[h])+"]: "+e(t[o[h]],t));return n}var Ir=Ve,Or=Ii,Pr=function t(e,i,n,s){var o=i||{};if(gr(o,"quoteStyle")&&"single"!==o.quoteStyle&&"double"!==o.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(gr(o,"maxStringLength")&&("number"==typeof o.maxStringLength?o.maxStringLength<0&&o.maxStringLength!==1/0:null!==o.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=!gr(o,"customInspect")||o.customInspect;if("boolean"!=typeof a&&"symbol"!==a)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(gr(o,"indent")&&null!==o.indent&&"\t"!==o.indent&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(gr(o,"numericSeparator")&&"boolean"!=typeof o.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var l=o.numericSeparator;if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return vr(e,o);if("number"==typeof e){if(0===e)return 1/0/e>0?"0":"-0";var h=String(e);return l?or(e,h):h}if("bigint"==typeof e){var c=String(e)+"n";return l?or(e,c):c}var p=void 0===o.depth?5:o.depth;if(void 0===n&&(n=0),n>=p&&p>0&&"object"==typeof e)return ur(e)?"[Array]":"[Object]";var u,d=function(t,e){var i;if("\t"===t.indent)i="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;i=Yn.call(Array(t.indent+1)," ")}return{base:i,prev:Yn.call(Array(e+1),i)}}(o,n);if(void 0===s)s=[];else if(br(s,e)>=0)return"[Circular]";function y(e,i,r){if(i&&(s=Xn.call(s)).push(i),r){var a={depth:o.depth};return gr(o,"quoteStyle")&&(a.quoteStyle=o.quoteStyle),t(e,a,n+1,s)}return t(e,o,n+1,s)}if("function"==typeof e&&!dr(e)){var f=function(t){if(t.name)return t.name;var e=Nn.call(_n.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}(e),g=Tr(e,y);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(g.length>0?" { "+Yn.call(g,", ")+" }":"")}if(yr(e)){var m=ir?$n.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):er.call(e);return"object"!=typeof e||ir?m:xr(m)}if((u=e)&&"object"==typeof u&&("undefined"!=typeof HTMLElement&&u instanceof HTMLElement||"string"==typeof u.nodeName&&"function"==typeof u.getAttribute)){for(var b="<"+qn.call(String(e.nodeName)),v=e.attributes||[],w=0;w<v.length;w++)b+=" "+v[w].name+"="+cr(pr(v[w].value),"double",o);return b+=">",e.childNodes&&e.childNodes.length&&(b+="..."),b+"</"+qn.call(String(e.nodeName))+">"}if(ur(e)){if(0===e.length)return"[]";var x=Tr(e,y);return d&&!function(t){for(var e=0;e<t.length;e++)if(br(t[e],"\n")>=0)return!1;return!0}(x)?"["+jr(x,d)+"]":"[ "+Yn.call(x,", ")+" ]"}if(function(t){return!("[object Error]"!==mr(t)||nr&&"object"==typeof t&&nr in t)}(e)){var S=Tr(e,y);return"cause"in Error.prototype||!("cause"in e)||rr.call(e,"cause")?0===S.length?"["+String(e)+"]":"{ ["+String(e)+"] "+Yn.call(S,", ")+" }":"{ ["+String(e)+"] "+Yn.call(Qn.call("[cause]: "+y(e.cause),S),", ")+" }"}if("object"==typeof e&&a){if(hr&&"function"==typeof e[hr]&&ar)return ar(e,{depth:p-n});if("symbol"!==a&&"function"==typeof e.inspect)return e.inspect()}if(function(t){if(!Cn||!t||"object"!=typeof t)return!1;try{Cn.call(t);try{Bn.call(t)}catch(b){return!0}return t instanceof Map}catch(nh){}return!1}(e)){var k=[];return Mn&&Mn.call(e,(function(t,i){k.push(y(i,e,!0)+" => "+y(t,e))})),kr("Map",Cn.call(e),k,d)}if(function(t){if(!Bn||!t||"object"!=typeof t)return!1;try{Bn.call(t);try{Cn.call(t)}catch(e){return!0}return t instanceof Set}catch(nh){}return!1}(e)){var j=[];return Fn&&Fn.call(e,(function(t){j.push(y(t,e))})),kr("Set",Bn.call(e),j,d)}if(function(t){if(!Dn||!t||"object"!=typeof t)return!1;try{Dn.call(t,Dn);try{Wn.call(t,Wn)}catch(b){return!0}return t instanceof WeakMap}catch(nh){}return!1}(e))return Sr("WeakMap");if(function(t){if(!Wn||!t||"object"!=typeof t)return!1;try{Wn.call(t,Wn);try{Dn.call(t,Dn)}catch(b){return!0}return t instanceof WeakSet}catch(nh){}return!1}(e))return Sr("WeakSet");if(function(t){if(!Rn||!t||"object"!=typeof t)return!1;try{return Rn.call(t),!0}catch(nh){}return!1}(e))return Sr("WeakRef");if(function(t){return!("[object Number]"!==mr(t)||nr&&"object"==typeof t&&nr in t)}(e))return xr(y(Number(e)));if(function(t){if(!t||"object"!=typeof t||!Zn)return!1;try{return Zn.call(t),!0}catch(nh){}return!1}(e))return xr(y(Zn.call(e)));if(function(t){return!("[object Boolean]"!==mr(t)||nr&&"object"==typeof t&&nr in t)}(e))return xr(Gn.call(e));if(function(t){return!("[object String]"!==mr(t)||nr&&"object"==typeof t&&nr in t)}(e))return xr(y(String(e)));if("undefined"!=typeof window&&e===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&e===globalThis||void 0!==r&&e===r)return"{ [object globalThis] }";if(!function(t){return!("[object Date]"!==mr(t)||nr&&"object"==typeof t&&nr in t)}(e)&&!dr(e)){var T=Tr(e,y),I=sr?sr(e)===Object.prototype:e instanceof Object||e.constructor===Object,O=e instanceof Object?"":"null prototype",P=!I&&nr&&Object(e)===e&&nr in e?Hn.call(mr(e),8,-1):O?"Object":"",A=(I||"function"!=typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(P||O?"["+Yn.call(Qn.call([],P||[],O||[]),": ")+"] ":"");return 0===T.length?A+"{}":d?A+"{"+jr(T,d)+"}":A+"{ "+Yn.call(T,", ")+" }"}return String(e)},Ar=te,Er=Ir("%WeakMap%",!0),Cr=Ir("%Map%",!0),Mr=Or("WeakMap.prototype.get",!0),zr=Or("WeakMap.prototype.set",!0),Lr=Or("WeakMap.prototype.has",!0),Br=Or("Map.prototype.get",!0),Fr=Or("Map.prototype.set",!0),Dr=Or("Map.prototype.has",!0),Wr=function(t,e){for(var i,n=t;null!==(i=n.next);n=i)if(i.key===e)return n.next=i.next,i.next=t.next,t.next=i,i},Rr=function(){var t,e,i,n={assert:function(t){if(!n.has(t))throw new Ar("Side channel does not contain "+Pr(t))},get:function(n){if(Er&&n&&("object"==typeof n||"function"==typeof n)){if(t)return Mr(t,n)}else if(Cr){if(e)return Br(e,n)}else if(i)return function(t,e){var i=Wr(t,e);return i&&i.value}(i,n)},has:function(n){if(Er&&n&&("object"==typeof n||"function"==typeof n)){if(t)return Lr(t,n)}else if(Cr){if(e)return Dr(e,n)}else if(i)return function(t,e){return!!Wr(t,e)}(i,n);return!1},set:function(n,r){Er&&n&&("object"==typeof n||"function"==typeof n)?(t||(t=new Er),zr(t,n,r)):Cr?(e||(e=new Cr),Fr(e,n,r)):(i||(i={key:{},next:null}),function(t,e,i){var n=Wr(t,e);n?n.value=i:t.next={key:e,next:t.next,value:i}}(i,n,r))}};return n},Gr=ye,Ur=Rr(),_r=te,Nr={assert:function(t,e){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new _r("`O` is not an object");if("string"!=typeof e)throw new _r("`slot` must be a string");if(Ur.assert(t),!Nr.has(t,e))throw new _r("`"+e+"` is not present on `O`")},get:function(t,e){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new _r("`O` is not an object");if("string"!=typeof e)throw new _r("`slot` must be a string");var i=Ur.get(t);return i&&i["$"+e]},has:function(t,e){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new _r("`O` is not an object");if("string"!=typeof e)throw new _r("`slot` must be a string");var i=Ur.get(t);return!!i&&Gr(i,"$"+e)},set:function(t,e,i){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new _r("`O` is not an object");if("string"!=typeof e)throw new _r("`slot` must be a string");var n=Ur.get(t);n||(n={},Ur.set(t,n)),n["$"+e]=i}};Object.freeze&&Object.freeze(Nr);var Hr,$r=Nr,Vr=SyntaxError,qr="object"==typeof StopIteration?StopIteration:null,Kr={}.toString,Qr=Array.isArray||function(t){return"[object Array]"==Kr.call(t)},Yr=String.prototype.valueOf,Xr=Object.prototype.toString,Jr=xn(),Zr=function(t){return"string"==typeof t||"object"==typeof t&&(Jr?function(t){try{return Yr.call(t),!0}catch(nh){return!1}}(t):"[object String]"===Xr.call(t))},ts="function"==typeof Map&&Map.prototype?Map:null,es="function"==typeof Set&&Set.prototype?Set:null;ts||(Hr=function(t){return!1});var is=ts?Map.prototype.has:null,ns=es?Set.prototype.has:null;Hr||is||(Hr=function(t){return!1});var rs,ss=Hr||function(t){if(!t||"object"!=typeof t)return!1;try{if(is.call(t),ns)try{ns.call(t)}catch(nh){return!0}return t instanceof ts}catch(nh){}return!1},os="function"==typeof Map&&Map.prototype?Map:null,as="function"==typeof Set&&Set.prototype?Set:null;as||(rs=function(t){return!1});var ls=os?Map.prototype.has:null,hs=as?Set.prototype.has:null;rs||hs||(rs=function(t){return!1});var cs=rs||function(t){if(!t||"object"!=typeof t)return!1;try{if(hs.call(t),ls)try{ls.call(t)}catch(nh){return!0}return t instanceof as}catch(nh){}return!1},ps=On,us=function(t){if(!qr)throw new Vr("this environment lacks StopIteration");$r.set(t,"[[Done]]",!1);var e={next:function(){var t=$r.get(this,"[[Iterator]]"),e=$r.get(t,"[[Done]]");try{return{done:e,value:e?void 0:t.next()}}catch(nh){if($r.set(t,"[[Done]]",!0),nh!==qr)throw nh;return{done:!0,value:void 0}}}};return $r.set(e,"[[Iterator]]",t),e};if(se()||ie()){var ds=Symbol.iterator;vn.exports=function(t){return null!=t&&void 0!==t[ds]?t[ds]():ps(t)?Array.prototype[ds].call(t):void 0}}else{var ys=Qr,fs=Zr,gs=Ve,ms=gs("%Map%",!0),bs=gs("%Set%",!0),vs=Ii,ws=vs("Array.prototype.push"),xs=vs("String.prototype.charCodeAt"),Ss=vs("String.prototype.slice"),ks=function(t){var e=0;return{next:function(){var i,n=e>=t.length;return n||(i=t[e],e+=1),{done:n,value:i}}}},js=function(t,e){if(ys(t)||ps(t))return ks(t);if(fs(t)){var i=0;return{next:function(){var e=function(t,e){if(e+1>=t.length)return e+1;var i=xs(t,e);if(i<55296||i>56319)return e+1;var n=xs(t,e+1);return n<56320||n>57343?e+1:e+2}(t,i),n=Ss(t,i,e);return i=e,{done:e>t.length,value:n}}}}return e&&void 0!==t["_es6-shim iterator_"]?t["_es6-shim iterator_"]():void 0};if(ms||bs){var Ts=ss,Is=cs,Os=vs("Map.prototype.forEach",!0),Ps=vs("Set.prototype.forEach",!0);if("undefined"==typeof process||!process.versions||!process.versions.node)var As=vs("Map.prototype.iterator",!0),Es=vs("Set.prototype.iterator",!0);var Cs=vs("Map.prototype.@@iterator",!0)||vs("Map.prototype._es6-shim iterator_",!0),Ms=vs("Set.prototype.@@iterator",!0)||vs("Set.prototype._es6-shim iterator_",!0);vn.exports=function(t){return function(t){if(Ts(t)){if(As)return us(As(t));if(Cs)return Cs(t);if(Os){var e=[];return Os(t,(function(t,i){ws(e,[i,t])})),ks(e)}}if(Is(t)){if(Es)return us(Es(t));if(Ms)return Ms(t);if(Ps){var i=[];return Ps(t,(function(t){ws(i,t)})),ks(i)}}}(t)||js(t)}}else vn.exports=function(t){if(null!=t)return js(t,!0)}}var zs=vn.exports,Ls=function(t){return t!=t},Bs=function(t,e){return 0===t&&0===e?1/t==1/e:t===e||!(!Ls(t)||!Ls(e))},Fs=Bs,Ds=function(){return"function"==typeof Object.is?Object.is:Fs},Ws=Ds,Rs=di,Gs=di,Us=Bs,_s=Ds,Ns=Si(_s(),Object);Gs(Ns,{getPolyfill:_s,implementation:Us,shim:function(){var t=Ws();return Rs(Object,{is:t},{is:function(){return Object.is!==t}}),t}});var Hs,$s,Vs,qs,Ks=Ns,Qs=Si,Ys=Ii,Xs=Ve("%ArrayBuffer%",!0),Js=Ys("ArrayBuffer.prototype.byteLength",!0),Zs=Ys("Object.prototype.toString"),to=!!Xs&&!Js&&new Xs(0).slice,eo=!!to&&Qs(to),io=Js||eo?function(t){if(!t||"object"!=typeof t)return!1;try{return Js?Js(t):eo(t,0),!0}catch(nh){return!1}}:Xs?function(t){return"[object ArrayBuffer]"===Zs(t)}:function(t){return!1},no=Date.prototype.getDay,ro=Object.prototype.toString,so=xn(),oo=Ii,ao=xn();if(ao){Hs=oo("Object.prototype.hasOwnProperty"),$s=oo("RegExp.prototype.exec"),Vs={};var lo=function(){throw Vs};qs={toString:lo,valueOf:lo},"symbol"==typeof Symbol.toPrimitive&&(qs[Symbol.toPrimitive]=lo)}var ho=oo("Object.prototype.toString"),co=Object.getOwnPropertyDescriptor,po=ao?function(t){if(!t||"object"!=typeof t)return!1;var e=co(t,"lastIndex");if(!e||!Hs(e,"value"))return!1;try{$s(t,qs)}catch(nh){return nh===Vs}}:function(t){return!(!t||"object"!=typeof t&&"function"!=typeof t)&&"[object RegExp]"===ho(t)},uo=Ii("SharedArrayBuffer.prototype.byteLength",!0),yo=uo?function(t){if(!t||"object"!=typeof t)return!1;try{return uo(t),!0}catch(nh){return!1}}:function(t){return!1},fo=Number.prototype.toString,go=Object.prototype.toString,mo=xn(),bo=Ii,vo=bo("Boolean.prototype.toString"),wo=bo("Object.prototype.toString"),xo=xn(),So={exports:{}},ko=Object.prototype.toString;if(se()){var jo=Symbol.prototype.toString,To=/^Symbol\(.*\)$/;So.exports=function(t){if("symbol"==typeof t)return!0;if("[object Symbol]"!==ko.call(t))return!1;try{return function(t){return"symbol"==typeof t.valueOf()&&To.test(jo.call(t))}(t)}catch(nh){return!1}}}else So.exports=function(t){return!1};var Io=So.exports,Oo={exports:{}},Po="undefined"!=typeof BigInt&&BigInt;if("function"==typeof Po&&"function"==typeof BigInt&&"bigint"==typeof Po(42)&&"bigint"==typeof BigInt(42)){var Ao=BigInt.prototype.valueOf;Oo.exports=function(t){return null!=t&&"boolean"!=typeof t&&"string"!=typeof t&&"number"!=typeof t&&"symbol"!=typeof t&&"function"!=typeof t&&("bigint"==typeof t||function(t){try{return Ao.call(t),!0}catch(nh){}return!1}(t))}}else Oo.exports=function(t){return!1};var Eo,Co=Oo.exports,Mo=Zr,zo=Io,Lo=Co,Bo="function"==typeof WeakMap&&WeakMap.prototype?WeakMap:null,Fo="function"==typeof WeakSet&&WeakSet.prototype?WeakSet:null;Bo||(Eo=function(t){return!1});var Do=Bo?Bo.prototype.has:null,Wo=Fo?Fo.prototype.has:null;Eo||Do||(Eo=function(t){return!1});var Ro=Eo||function(t){if(!t||"object"!=typeof t)return!1;try{if(Do.call(t,Do),Wo)try{Wo.call(t,Wo)}catch(nh){return!0}return t instanceof Bo}catch(nh){}return!1},Go={exports:{}},Uo=Ii,_o=Ve("%WeakSet%",!0),No=Uo("WeakSet.prototype.has",!0);if(No){var Ho=Uo("WeakMap.prototype.has",!0);Go.exports=function(t){if(!t||"object"!=typeof t)return!1;try{if(No(t,No),Ho)try{Ho(t,Ho)}catch(nh){return!0}return t instanceof _o}catch(nh){}return!1}}else Go.exports=function(t){return!1};var $o,Vo,qo=Go.exports,Ko=ss,Qo=cs,Yo=Ro,Xo=qo,Jo=Function.prototype.toString,Zo="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof Zo&&"function"==typeof Object.defineProperty)try{$o=Object.defineProperty({},"length",{get:function(){throw Vo}}),Vo={},Zo((function(){throw 42}),null,$o)}catch(rh){rh!==Vo&&(Zo=null)}else Zo=null;var ta=/^\s*class\b/,ea=function(t){try{var e=Jo.call(t);return ta.test(e)}catch(nh){return!1}},ia=function(t){try{return!ea(t)&&(Jo.call(t),!0)}catch(nh){return!1}},na=Object.prototype.toString,ra="function"==typeof Symbol&&!!Symbol.toStringTag,sa=!(0 in[,]),oa=function(){return!1};if("object"==typeof document){var aa=document.all;na.call(aa)===na.call(document.all)&&(oa=function(t){if((sa||!t)&&(void 0===t||"object"==typeof t))try{var e=na.call(t);return("[object HTMLAllCollection]"===e||"[object HTML document.all class]"===e||"[object HTMLCollection]"===e||"[object Object]"===e)&&null==t("")}catch(nh){}return!1})}var la=Zo?function(t){if(oa(t))return!0;if(!t)return!1;if("function"!=typeof t&&"object"!=typeof t)return!1;try{Zo(t,null,$o)}catch(nh){if(nh!==Vo)return!1}return!ea(t)&&ia(t)}:function(t){if(oa(t))return!0;if(!t)return!1;if("function"!=typeof t&&"object"!=typeof t)return!1;if(ra)return ia(t);if(ea(t))return!1;var e=na.call(t);return!("[object Function]"!==e&&"[object GeneratorFunction]"!==e&&!/^\[object HTML/.test(e))&&ia(t)},ha=Object.prototype.toString,ca=Object.prototype.hasOwnProperty,pa=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],ua="undefined"==typeof globalThis?r:globalThis,da=function(t,e,i){if(!la(e))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=i),"[object Array]"===ha.call(t)?function(t,e,i){for(var n=0,r=t.length;n<r;n++)ca.call(t,n)&&(null==i?e(t[n],n,t):e.call(i,t[n],n,t))}(t,e,n):"string"==typeof t?function(t,e,i){for(var n=0,r=t.length;n<r;n++)null==i?e(t.charAt(n),n,t):e.call(i,t.charAt(n),n,t)}(t,e,n):function(t,e,i){for(var n in t)ca.call(t,n)&&(null==i?e(t[n],n,t):e.call(i,t[n],n,t))}(t,e,n)},ya=Si,fa=Ii,ga=Ye,ma=fa("Object.prototype.toString"),ba=xn(),va="undefined"==typeof globalThis?r:globalThis,wa=function(){for(var t=[],e=0;e<pa.length;e++)"function"==typeof ua[pa[e]]&&(t[t.length]=pa[e]);return t}(),xa=fa("String.prototype.slice"),Sa=Object.getPrototypeOf,ka=fa("Array.prototype.indexOf",!0)||function(t,e){for(var i=0;i<t.length;i+=1)if(t[i]===e)return i;return-1},ja={__proto__:null};da(wa,ba&&ga&&Sa?function(t){var e=new va[t];if(Symbol.toStringTag in e){var i=Sa(e),n=ga(i,Symbol.toStringTag);if(!n){var r=Sa(i);n=ga(r,Symbol.toStringTag)}ja["$"+t]=ya(n.get)}}:function(t){var e=new va[t],i=e.slice||e.set;i&&(ja["$"+t]=ya(i))});var Ta=Ii("ArrayBuffer.prototype.byteLength",!0),Ia=io,Oa=Hi,Pa=Ii,Aa=bn,Ea=Ve,Ca=zs,Ma=Rr,za=Ks,La=On,Ba=Qr,Fa=io,Da=function(t){return"object"==typeof t&&null!==t&&(so?function(t){try{return no.call(t),!0}catch(nh){return!1}}(t):"[object Date]"===ro.call(t))},Wa=po,Ra=yo,Ga=Kt,Ua=function(t){return null==t||"object"!=typeof t&&"function"!=typeof t?null:Mo(t)?"String":function(t){return"number"==typeof t||"object"==typeof t&&(mo?function(t){try{return fo.call(t),!0}catch(nh){return!1}}(t):"[object Number]"===go.call(t))}(t)?"Number":function(t){return"boolean"==typeof t||null!==t&&"object"==typeof t&&(xo&&Symbol.toStringTag in t?function(t){try{return vo(t),!0}catch(nh){return!1}}(t):"[object Boolean]"===wo(t))}(t)?"Boolean":zo(t)?"Symbol":Lo(t)?"BigInt":void 0},_a=function(t){if(t&&"object"==typeof t){if(Ko(t))return"Map";if(Qo(t))return"Set";if(Yo(t))return"WeakMap";if(Xo(t))return"WeakSet"}return!1},Na=function(t){if(!t||"object"!=typeof t)return!1;if(!ba){var e=xa(ma(t),8,-1);return ka(wa,e)>-1?e:"Object"===e&&function(t){var e=!1;return da(ja,(function(i,n){if(!e)try{i(t),e=xa(n,1)}catch(nh){}})),e}(t)}return ga?function(t){var e=!1;return da(ja,(function(i,n){if(!e)try{"$"+i(t)===n&&(e=xa(n,1))}catch(nh){}})),e}(t):null},Ha=function(t){return Ia(t)?Ta?Ta(t):t.byteLength:NaN},$a=Pa("SharedArrayBuffer.prototype.byteLength",!0),Va=Pa("Date.prototype.getTime"),qa=Object.getPrototypeOf,Ka=Pa("Object.prototype.toString"),Qa=Ea("%Set%",!0),Ya=Pa("Map.prototype.has",!0),Xa=Pa("Map.prototype.get",!0),Ja=Pa("Map.prototype.size",!0),Za=Pa("Set.prototype.add",!0),tl=Pa("Set.prototype.delete",!0),el=Pa("Set.prototype.has",!0),il=Pa("Set.prototype.size",!0);function nl(t,e,i,n){for(var r,s=Ca(t);(r=s.next())&&!r.done;)if(ll(e,r.value,i,n))return tl(t,r.value),!0;return!1}function rl(t){return void 0===t?null:"object"!=typeof t?"symbol"!=typeof t&&("string"!=typeof t&&"number"!=typeof t||+t==+t):void 0}function sl(t,e,i,n,r,s){var o=rl(i);if(null!=o)return o;var a=Xa(e,o),l=Oa({},r,{strict:!1});return!(void 0===a&&!Ya(e,o)||!ll(n,a,l,s))&&!Ya(t,o)&&ll(n,a,l,s)}function ol(t,e,i){var n=rl(i);return null!=n?n:el(e,n)&&!el(t,n)}function al(t,e,i,n,r,s){for(var o,a,l=Ca(t);(o=l.next())&&!o.done;)if(ll(i,a=o.value,r,s)&&ll(n,Xa(e,a),r,s))return tl(t,a),!0;return!1}function ll(t,e,i,n){var r=i||{};if(r.strict?za(t,e):t===e)return!0;if(Ua(t)!==Ua(e))return!1;if(!t||!e||"object"!=typeof t&&"object"!=typeof e)return r.strict?za(t,e):t==e;var s,o=n.has(t),a=n.has(e);if(o&&a){if(n.get(t)===n.get(e))return!0}else s={};return o||n.set(t,s),a||n.set(e,s),function(t,e,i,n){var r,s;if(typeof t!=typeof e)return!1;if(null==t||null==e)return!1;if(Ka(t)!==Ka(e))return!1;if(La(t)!==La(e))return!1;if(Ba(t)!==Ba(e))return!1;var o=t instanceof Error,a=e instanceof Error;if(o!==a)return!1;if((o||a)&&(t.name!==e.name||t.message!==e.message))return!1;var l=Wa(t),h=Wa(e);if(l!==h)return!1;if((l||h)&&(t.source!==e.source||Aa(t)!==Aa(e)))return!1;var c=Da(t),p=Da(e);if(c!==p)return!1;if((c||p)&&Va(t)!==Va(e))return!1;if(i.strict&&qa&&qa(t)!==qa(e))return!1;var u=Na(t),d=Na(e);if(u!==d)return!1;if(u||d){if(t.length!==e.length)return!1;for(r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}var y=hl(t),f=hl(e);if(y!==f)return!1;if(y||f){if(t.length!==e.length)return!1;for(r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}var g=Fa(t),m=Fa(e);if(g!==m)return!1;if(g||m)return Ha(t)===Ha(e)&&"function"==typeof Uint8Array&&ll(new Uint8Array(t),new Uint8Array(e),i,n);var b=Ra(t),v=Ra(e);if(b!==v)return!1;if(b||v)return $a(t)===$a(e)&&"function"==typeof Uint8Array&&ll(new Uint8Array(t),new Uint8Array(e),i,n);if(typeof t!=typeof e)return!1;var w=Ga(t),x=Ga(e);if(w.length!==x.length)return!1;for(w.sort(),x.sort(),r=w.length-1;r>=0;r--)if(w[r]!=x[r])return!1;for(r=w.length-1;r>=0;r--)if(!ll(t[s=w[r]],e[s],i,n))return!1;var S=_a(t),k=_a(e);return S===k&&("Set"===S||"Set"===k?function(t,e,i,n){if(il(t)!==il(e))return!1;for(var r,s,o,a=Ca(t),l=Ca(e);(r=a.next())&&!r.done;)if(r.value&&"object"==typeof r.value)o||(o=new Qa),Za(o,r.value);else if(!el(e,r.value)){if(i.strict)return!1;if(!ol(t,e,r.value))return!1;o||(o=new Qa),Za(o,r.value)}if(o){for(;(s=l.next())&&!s.done;)if(s.value&&"object"==typeof s.value){if(!nl(o,s.value,i.strict,n))return!1}else if(!i.strict&&!el(t,s.value)&&!nl(o,s.value,i.strict,n))return!1;return 0===il(o)}return!0}(t,e,i,n):"Map"!==S||function(t,e,i,n){if(Ja(t)!==Ja(e))return!1;for(var r,s,o,a,l,h,c=Ca(t),p=Ca(e);(r=c.next())&&!r.done;)if(a=r.value[0],l=r.value[1],a&&"object"==typeof a)o||(o=new Qa),Za(o,a);else if(void 0===(h=Xa(e,a))&&!Ya(e,a)||!ll(l,h,i,n)){if(i.strict)return!1;if(!sl(t,e,a,l,i,n))return!1;o||(o=new Qa),Za(o,a)}if(o){for(;(s=p.next())&&!s.done;)if(a=s.value[0],h=s.value[1],a&&"object"==typeof a){if(!al(o,t,a,h,i,n))return!1}else if(!(i.strict||t.has(a)&&ll(Xa(t,a),h,i,n)||al(o,t,a,h,Oa({},i,{strict:!1}),n)))return!1;return 0===il(o)}return!0}(t,e,i,n))}(t,e,r,n)}function hl(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0]||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))}const cl=s((function(t,e,i){return ll(t,e,i,Ma())}));function pl(t){return{player:{x:t.player.x,y:t.player.y,flip:t.player.flipX},journal:t.player.journal.journal,inventory:t.player.inventory.inventory,quests:t.player.quests.quests,settings:{gamepad:t.gamepad.visible,debug:d.debug,zoomed:d.zoomed}}}function ul(){const t=localStorage.getItem(At);let e,i;try{t&&(e=JSON.parse(t))}catch(n){console.error(n),i=n}return{save:e||Mt[Et.New],error:i}}function dl(t,e){const i={...d};return d.debug=t.settings.debug,d.zoomed=t.settings.zoomed,d.zoomed!==i.zoomed?(function(t,e){const i=e?l:a;d.zoomed=e,d.width=i.width,d.height=i.height,d.cameraOffset=i.height/3,t.scale.setGameSize(i.width,i.height),t.scene.restart()}(e,d.zoomed),!0):d.debug!==i.debug&&(e.scene.restart(),!0)}function yl(t){const{save:e,error:i}=ul();i&&new St(t,"Unfortunately, it looks like this save is corrupted.\nFailed to Load Game",1e4);try{dl(e,t),t.player.setX(e.player.x),t.player.setY(e.player.y),t.player.setFlipX(e.player.flip),t.time.delayedCall(50,(()=>{t.player.journal.createUI(),t.player.inventory.createUI(),t.player.quests.createUI(),e.journal.forEach((e=>t.player.journal.addEntry(e,!0))),e.inventory.forEach((e=>t.player.inventory.addItem(e,!0))),e.quests.forEach((e=>t.player.quests.addQuest(e,!0)))})),t.gamepad.setVisible(e.settings.gamepad),cl(e,Mt[Et.New]),t.time.delayedCall(200,(()=>{new St(t,"Game Loaded ")})),cl(e,Mt[Et.New])&&fl(t,void 0,!0)}catch(n){console.error(n),new St(t,"Unfortunately, it looks like this save is corrupted.\nFailed to Load Game",1e4),fl(t,Mt[Et.New]),yl(t)}}function fl(t,e,i){const n=pl(t);localStorage.setItem(At,JSON.stringify(e||n)),i||new St(t,"Game Saved")}i.GameObjects.Container;class gl extends i.Physics.Arcade.Image{constructor(t,n,r){var s;const{x:o,y:a,image:l,scale:h}=n;super(t,o,a,l),e(this,"player"),e(this,"initialized",!1),e(this,"info"),e(this,"center"),this.info=n,this.player=r,this.setOrigin(0).setDepth(f.Backgrounds),yt(this,n);const c=null==(s=t.textures.get(l))?void 0:s.getSourceImage();this.center=new i.Math.Vector2(o+c.width*(h||1)/2,a+c.height*((h||1)/2))}lazyInit(t){(t||!this.initialized&&W(this.center,this.player,2e3))&&(this.scene.add.existing(this),this.scene.physics.add.existing(this),d.debug&&this.setInteractive({draggable:!0}),this.initialized=!0)}update(){this.lazyInit()}}function ml(){return Math.random()-.5}const bl=[3200,600],vl=[5350,690],wl=[500,200,100,50,10];class xl extends i.GameObjects.GameObject{constructor(t,n,r,s=40,o=[1400,600]){super(t,"fireflies"),e(this,"scene"),e(this,"center"),e(this,"lights",[]),e(this,"count"),e(this,"centers",[]),e(this,"bounds",[1e3,400]),e(this,"biases",[]),e(this,"initialized",!1),e(this,"debug"),t.add.existing(this),this.scene=t,this.count=s,this.bounds=o,this.center=new i.Math.Vector2(n,r),this.setPosition(n,r)}setPosition(t,e){this.centers=[];for(let n=0;n<this.count;n++)this.centers.push(new i.Math.Vector2(t+Math.random()*this.bounds[0]-this.bounds[0]/2,e+Math.random()*this.bounds[1]-this.bounds[1]/2));this.debug&&this.debug.setPosition(t-this.bounds[0]/2,e-this.bounds[1]/2)}lazyInit(t){if(t||!this.initialized&&W(this.center,this.scene.player)){for(let t=0;t<this.count;t++){const t=new i.Display.Color(40*Math.random()+50,60*Math.random()+190,20*Math.random()+10),e=this.scene.lights.addPointLight(0,0,t.color,7*Math.random()+3,.15,.045+.02*ml());this.lights.push(e);const n=[];for(let i=0;i<2*wl.length;i++)n.push(ml()*wl[i%wl.length]);n.push(10*ml()),this.biases.push(n)}this.setPosition(this.center.x,this.center.y),d.debug&&(this.debug=this.scene.add.graphics().fillStyle(16711680,.5).lineStyle(2,16711680,1),this.debug.fillCircle(this.bounds[0]/2,this.bounds[1]/2,10),this.debug.strokeRect(0,0,this.bounds[0],this.bounds[1])),this.initialized=!0}}update(t,e){if(this.lazyInit(),!(Math.abs(this.scene.player.x-this.center.x)<=this.bounds[0]))return;const i=t/1e3*.025,n=Math.cos(i),r=Math.sin(i);this.lights.forEach(((t,e)=>{const s=this.biases[e],o=Math.cos(70*i+s[10]);t.intensity=Math.min(.05+Math.abs(s[4]*o+s[3]*n+s[4]*n)/50,.4),t.x=n*s[0]+r*s[1]+n*s[2]+r*s[3]+n*s[4]+this.centers[e].x,t.y=r*s[5]+n*s[6]+r*s[7]+n*s[8]+r*s[9]+this.centers[e].y}))}}class Sl extends i.Physics.Arcade.Image{constructor(t,i,n,r=100,s=100,o=!1,a=!1){super(t,i,n,""),e(this,"scene"),e(this,"width"),e(this,"height"),e(this,"flipped"),e(this,"upwards"),e(this,"graphics"),e(this,"initialized",!1),this.scene=t,this.width=r,this.height=s,this.flipped=o,this.upwards=a}lazyInit(t){if(t||!this.initialized&&W(this,this.scene.player)){if(this.scene.add.existing(this),this.scene.physics.add.existing(this),this.setOrigin(0).setDepth(f.Debug),d.debug||this.setVisible(!1),this.setSize(this.width,1.5*this.height),d.debug){this.setInteractive({draggable:!0});const t=this.scene.add.graphics().setDepth(f.Debug);this.graphics=t,t.lineStyle(2,65280,1);const e=this.width/2,n=new i.Math.Vector2(0,this.flipped?0:0+this.height),r=new i.Math.Vector2(0+this.width,this.flipped?0+this.height:0);t.lineBetween(n.x,n.y,r.x,r.y),t.lineBetween(n.x-e,n.y,n.x,n.y),t.lineBetween(r.x,r.y,r.x+e,r.y),t.strokeCircle(n.x,n.y,2),t.strokeCircle(r.x,r.y,2)}this.initialized=!0}}update(t,e){if(this.lazyInit(),!this.initialized)return;d.debug&&this.graphics&&this.graphics.setPosition(this.x,this.y);const n=this.scene.player,r=n.keys.keys;if(this.body&&this.scene.physics.world.intersects(this.body,n.body)){let t=i.Math.Clamp(1-(this.x+this.width-n.x)/this.width,0,1);this.flipped&&(t=1-t);const e=this.y+this.height,s=(1-n.originY)*n.displayHeight,o=e-this.height*t-s;if(this.upwards&&r[E.Up]&&Math.abs(n.y-o)<70)return n.setVelocityX(this.flipped?-It:It),n.setFlipX(this.flipped),void n.setY(o);if(this.upwards&&(r[E.Right]||r[E.Left]&&this.flipped)&&n.y<e-70)return void n.setY(o);if(this.upwards&&o<n.y)return;n.setY(o)}}}class kl extends i.Physics.Arcade.StaticGroup{constructor(t,i){super(t.physics.world,t),e(this,"player"),e(this,"initialized",[]),this.player=i,ft.forEach(((t,e)=>{void 0!==t.id&&this.createWall(t,e)}))}createWall(t,e){const i=this.scene.add.rectangle(t.x,t.y,6,100).setOrigin(0).setVisible(d.debug);t.id&&i.setData("WallType",t.id),d.debug&&i.setInteractive({draggable:!0}),this.add(i),this.initialized.push(e)}update(){ft.forEach(((t,e)=>{this.initialized.includes(e)||i.Math.Distance.BetweenPointsSquared(t,this.player)<1e6&&this.createWall(t,e)}))}}class jl extends i.GameObjects.Container{constructor(t,i){super(t,100,d.height-100),e(this,"buttons",[]),e(this,"lastAxisKey"),e(this,"minimal"),this.minimal=i,this.setScrollFactor(0).setDepth(f.Overlay)}createUI(){this.scene.add.existing(this),this.createDPad(),this.minimal||this.createButtons(),this.createControllerListeners()}setVisible(t){return super.setVisible(t),t&&0===this.buttons.length&&this.createUI(),this}update(t,e){var i,n,r,s,o,a;const l=null==(i=this.scene.input.gamepad)?void 0:i.pad1;if(!l)return;const h=l.axes[0].getValue();if(Math.abs(h)<=.1&&this.lastAxisKey)return null==(n=this.scene.input.keyboard)||n.emit("keyup-"+this.lastAxisKey),void(this.lastAxisKey=void 0);if(h>.1){if("RIGHT"===this.lastAxisKey)return;"LEFT"===this.lastAxisKey&&(null==(r=this.scene.input.keyboard)||r.emit("keyup-LEFT")),null==(s=this.scene.input.keyboard)||s.emit("keydown-RIGHT"),this.lastAxisKey="RIGHT"}if(h<-.1){if("LEFT"===this.lastAxisKey)return;"RIGHT"===this.lastAxisKey&&(null==(o=this.scene.input.keyboard)||o.emit("keyup-RIGHT")),null==(a=this.scene.input.keyboard)||a.emit("keydown-LEFT"),this.lastAxisKey="LEFT"}}createDPad(){const t=this.scene.add.container(10,-10);this.add(t);const e=this.scene.add.circle(0,0,60,I(T.Teal),.45).setStrokeStyle(3,I(T.Black));t.add(e),this.button(-57,0,"LEFT",t),this.button(57,0,"RIGHT",t),this.button(0,-57,"UP",t),this.button(0,57,"DOWN",t)}createButtons(){const t=this.scene.add.container(d.width-300,0);this.add(t);const e=this.scene.add.circle(40,0,65,I(T.Teal),.45).setStrokeStyle(3,I(T.Black)).setScale(1,.6).setAngle(-30);t.add(e),this.button(80,-20,"ENTER",t),this.button(0,20,"BACKSPACE",t)}createControllerListeners(){var t,e,i,n;null==(t=this.scene.input.gamepad)||t.on("connected",(t=>{new St(this.scene,"Gamepad connected")})),null==(e=this.scene.input.gamepad)||e.on("disconnected",(t=>{new St(this.scene,"Gamepad disconnected")})),null==(i=this.scene.input.gamepad)||i.on("down",((t,e)=>{var i;const n=this.getKeyFromButton(e);n&&(null==(i=this.scene.input.keyboard)||i.emit(`keydown-${n}`)),console.log("down",e)})),null==(n=this.scene.input.gamepad)||n.on("up",((t,e)=>{var i;const n=this.getKeyFromButton(e);n&&(null==(i=this.scene.input.keyboard)||i.emit(`keyup-${n}`)),console.log("up",e)}))}getKeyFromButton(t){let e;switch(t.index){case 0:e=t.pad.id.toLowerCase().includes("nintendo")?"BACKSPACE":"ENTER";break;case 1:e=t.pad.id.toLowerCase().includes("nintendo")?"ENTER":"BACKSPACE";break;case 9:e="ESC";break;case 12:e="UP";break;case 13:e="DOWN";break;case 14:e="LEFT";break;case 15:e="RIGHT"}return e}button(t,e,i,n){const r="ENTER"===i||"ESCAPE"===i?35:38,s=this.scene.add.circle(t,e,r,I(T.White),.8).setStrokeStyle(3,I(T.Black));s.setInteractive({useHandCursor:!0}).setScrollFactor(0),n.add(s),s.on("pointerdown",(()=>{var t;null==(t=this.scene.input.keyboard)||t.emit(`keydown-${i}`),s.setFillStyle(I(T.Teal),Math.min(1,1.05))})),s.on("pointerup",(()=>{var t;null==(t=this.scene.input.keyboard)||t.emit(`keyup-${i}`),s.setFillStyle(I(T.White),.8)})),s.on("pointerout",(()=>{var t;null==(t=this.scene.input.keyboard)||t.emit(`keyup-${i}`),s.setFillStyle(I(T.White),.8)})),this.buttons.push(s)}offsetButtons(t){t?this.setPosition(100,d.height-300):this.setPosition(100,d.height-100)}}class Tl extends i.GameObjects.Container{constructor(t,i,n,r,s){super(t,i,n),e(this,"img"),e(this,"rect"),t.add.existing(this),this.setScrollFactor(0).setDepth(f.Ui),this.rect=t.add.rectangle(0,0,42,42,I(T.Teal)).setScrollFactor(0).setStrokeStyle(2,I(T.Black)),this.img=t.add.image(-1,1,r).setDisplaySize(32,32),this.add(this.rect),this.add(this.img),this.rect.setInteractive({useHandCursor:!0}).on("pointerdown",(()=>s(this))),this.rect.on("pointerover",(()=>{this.rect.setScale(1.1),this.img.setDisplaySize(36,36)})),this.rect.on("pointerout",(()=>{this.rect.setScale(1),this.img.setDisplaySize(32,32)}))}}const Il=[{x:0,y:0,image:"town"},{x:500,y:-1100,image:"clock_outside"},{x:500,y:-2400,image:"clock_inner",skipLighting:!0},{x:2300,y:0,image:"forest"},{x:4400,y:100,image:"lake"},{x:-2200,y:-170,image:"mansion_outside"},{x:-2e3,y:-1320,image:"mansion_inside",skipLighting:!0},{x:-2200,y:1300,image:"alchemy_lab",scale:.9,skipLighting:!0}],Ol=[{x:135,y:462,radius:150,color:I(T.Tan),intensity:2.5},{x:697,y:441},{x:1018,y:435},{x:887,y:200,radius:150},{x:1561,y:460},{x:791,y:472,intensity:.5},{x:962,y:469,intensity:.5},{x:162,y:814,intensity:2},{x:635,y:772},{x:1638,y:788,intensity:2},{x:5300,y:530,intensity:2},{x:5315,y:730,intensity:.75,radius:75}],Pl=[{x:740,y:-1370,width:170,height:95},{x:815,y:-2010,width:90,height:70},{x:5150,y:953,width:100,height:60,flip:!0},{x:5820,y:795,width:220,height:220},{x:-1300,y:-415,width:90,height:35},{x:-710,y:1577,width:280,height:190,upwards:!0},{x:-20,y:1697,width:200,height:70},{x:-1570,y:1728,width:200,height:40,flip:!0}];class Al extends i.Scene{constructor(){super("Game"),e(this,"player"),e(this,"interactiveObjects"),e(this,"clock"),e(this,"gamepad"),e(this,"shouldInit",!0)}init(){const t=function(t){const{save:e}=ul();try{return dl(e,t)}catch(i){console.error(i)}return!1}(this);this.shouldInit=!t}create(){if(!this.shouldInit)return;const t=performance.now();F(this,500),this.player=new Pt(this);const e=this.createBackgrounds(),i=new kl(this,this.player),n=this.createWarpers(),r=this.createNpcs(),s=this.createItems(),o=this.createSlopes(),a=this.createProps(),l=new xl(this,bl[0],bl[1]),h=new xl(this,vl[0],vl[1]);this.createLights(),this.createUI(),this.player,this.interactiveObjects=this.add.group([...n,...r,...s,...a],{runChildUpdate:!0});const c=this.add.group([this.player,this.gamepad,l,h,...o,i,...e],{runChildUpdate:!0});this.clock&&c.add(this.clock),this.physics.add.collider(this.player,i),this.createEventListeners();const p=this.cameras.main;p.startFollow(this.player,!0),p.setFollowOffset(0,d.cameraOffset),yl(this),(performance.now()-t).toFixed(1)}update(){this.physics.overlap(this.interactiveObjects,this.player,this.player.setInteractiveObject,((t,e)=>{const i=t;let n=!0;return i.disabled&&(n=!1),void 0!==i.visible&&(n=n&&i.visible),n}),this.player)||this.player.setInteractiveObject(void 0)}createBackgrounds(){return Il.map((t=>new gl(this,t,this.player)))}createWarpers(){const t=[];for(const e in b)isNaN(Number(e))&&t.push(new it(this,b[e],this.player));return t}createNpcs(){return Object.values(x).filter((t=>"number"==typeof t)).map((t=>new Q(this,t,this.player)))}createItems(){return[v.Gear1,v.Key].map((t=>new V(this,t,this.player)))}createSlopes(){return Pl.map((t=>new Sl(this,t.x,t.y,t.width,t.height,t.flip,t.upwards)))}createProps(){return Object.values(j).filter((t=>"number"==typeof t)).map((t=>new Y(this,t,this.player)))}createUI(){this.time.delayedCall(50,(()=>{new Tl(this,31,30,"settings",(()=>{this.scene.pause(),this.scene.launch("Paused",{game:this})})),new Tl(this,81,30,Bt(this)?"moon":"sun",(t=>{const e=Bt(this);var i;Bt(i=this)?function(t,e=!0){Lt||(Dt(t,T.Night,e),t.lights.lights.forEach((i=>{const n=i.intensity;i.setVisible(!0),e&&(i.setIntensity(0),t.tweens.add({targets:i,duration:zt,intensity:n}))})))}(i):Ft(i),t.img.setTexture(e?"sun":"moon")})),new Tl(this,131,30,d.zoomed?"zoom-out":"zoom-in",(()=>{const t=pl(this);fl(this,{...t,settings:{...t.settings,zoomed:!d.zoomed}}),this.scene.restart()}))})),this.gamepad=new jl(this)}createLights(){this.lights.enable().setAmbientColor(I(T.White)),Ol.forEach((t=>{d.debug?new g(this,t.x,t.y,t.radius||100,t.color||I(T.Lights),t.intensity||1):this.lights.addLight(t.x,t.y,t.radius||100,t.color||I(T.Lights),t.intensity||1)})),Ft(this,!1)}createEventListeners(){var t;null==(t=this.input.keyboard)||t.on("keydown-ESC",(()=>{this.scene.pause(),this.scene.launch("Paused",{game:this})})),this.events.on("resume",(()=>{this.player.keys.resetKeys()}))}}class El extends i.Scene{constructor(){super("Preloader"),e(this,"container")}init(){this.add.image(0,0,"splash").setOrigin(0).setDisplaySize(d.width,d.height),this.add.image(30,d.height-15,"logo").setOrigin(0,1).setScale(.25);const t=.68*d.width,e=this.add.container(.23*d.width,.91*d.height);this.container=e;const i=this.add.rectangle(0,0,t,26).setStrokeStyle(1,16777215,.85).setOrigin(0);e.add(i);const n=this.add.rectangle(3,3,0,20,16777215,.85).setOrigin(0);e.add(n),this.load.on("progress",(e=>{const i=.6*e;n.width=(t-6)*i})),this.load.on("complete",(()=>{this.tweens.add({targets:n,width:t-6,duration:2400})}));const r=document.createElement("img");r.src="assets/icons/settings.svg",r.id="loading",this.add.dom(0,0,r),F(this,300)}preload(){this.load.setPath("assets"),this.load.svg("sun","icons/sun.svg",{width:64,height:64}),this.load.svg("moon","icons/moon.svg",{width:64,height:64}),this.load.svg("settings","icons/settings.svg",{width:64,height:64}),this.load.svg("zoom-in","icons/zoom-in.svg",{width:64,height:64}),this.load.svg("zoom-out","icons/zoom-out.svg",{width:64,height:64}),this.load.svg("terminal","icons/terminal.svg",{width:64,height:64}),this.load.image("town","maps/town.jpg"),this.load.image("clock_outside","maps/clock_outside.jpg"),this.load.image("clock_inner","maps/clock_inner.jpg"),this.load.image("forest","maps/forest.jpg"),this.load.image("lake","maps/lake.jpg"),this.load.image("mansion_outside","maps/mansion_outside_hatch.jpg"),this.load.image("mansion_inside","maps/mansion_inside.jpg"),this.load.image("alchemy_lab","maps/alchemy_lab.jpg"),this.load.image("ladder","ladder.png"),this.load.image("warp","warp.png"),this.load.image("watch","watch.png"),this.load.image("arrow","arrow.png"),this.load.image("gear","items/gear.png"),this.load.image("gear2","items/gear2.png"),this.load.image("journal","items/journal.png"),this.load.image("wrench","items/wrench.png"),this.load.image("key","items/key.png"),this.load.image("herb_red","items/herb_red.png"),this.load.image("herb_green","items/herb_green.png"),this.load.image("herb_blue","items/herb_blue.png"),this.load.image("potion","items/potion.png"),this.load.spritesheet("character","characters/player.png",{frameWidth:128,frameHeight:80}),this.load.image("player_portrait","characters/player_portrait.png"),this.load.image("inventor","characters/inventor.png"),this.load.image("inventor_portrait","characters/inventor_portrait.png"),this.load.image("stranger","characters/stranger.png"),this.load.image("stranger_portrait","characters/stranger_portrait.png"),this.load.image("sphinx","characters/sphinx.png"),this.load.image("sphinx_portrait","characters/sphinx_portrait.png"),this.load.image("mayor","characters/mayor.png"),this.load.image("mayor_portrait","characters/mayor_portrait.png"),this.load.image("clock_portrait","characters/clock_portrait.png"),this.load.image("book","props/book.png"),this.load.image("picture","props/picture.png"),this.load.image("alchemy_empty","props/alchemy/alchemy_empty.png"),this.load.image("alchemy_green","props/alchemy/alchemy_green.png"),this.load.image("alchemy_red","props/alchemy/alchemy_red.png"),this.load.image("alchemy_blue","props/alchemy/alchemy_blue.png"),this.load.image("alchemy_full","props/alchemy/alchemy_full.png")}create(){this.time.delayedCall(3e3,(()=>{D(this,300,(()=>{this.scene.stop(this),this.scene.start("Game")}))}))}}class Cl extends i.GameObjects.Container{constructor(t,n,r,s,o,a){var l,h;super(t,n,r),e(this,"textObject"),e(this,"maskGraphics"),e(this,"scrollbar"),e(this,"scrollY"),e(this,"boxHeight"),t.add.existing(this),this.scrollY=0,this.boxHeight=0,this.textObject=new i.GameObjects.Text(t,0,0,s,{...P,padding:{x:10,y:10},...o}),this.textObject.setOrigin(0).setScrollFactor(0).setInteractive(),this.add(this.textObject),t.input.on("wheel",this.handleScroll,this),this.textObject.on("pointermove",this.handleDrag,this),this.textObject.on("pointerdown",((t,e,i)=>{const n=this.textObject.getWrappedText().length,r=i/this.textObject.height,s=Math.floor(r*n);a&&a(s)})),null==(l=t.input.keyboard)||l.on("keydown-UP",(()=>{this.scrollY-=30,this.updateTextPosition()})),null==(h=t.input.keyboard)||h.on("keydown-DOWN",(()=>{this.scrollY+=30,this.updateTextPosition()})),this.maskGraphics=t.add.graphics().setPosition(n,r).setScrollFactor(0).setVisible(!1),this.add(this.maskGraphics),this.scrollbar=t.add.rectangle(0,0,4,0,5592405).setScrollFactor(0),this.add(this.scrollbar)}setBoxSize(t,e){this.boxHeight=e,this.maskGraphics.clear(),this.maskGraphics.fillStyle(16777215),this.maskGraphics.fillRect(0,0,t,e);const i=this.maskGraphics.createGeometryMask();return this.textObject.setMask(i),this.textObject.setWordWrapWidth(t-8),this.textObject.setFixedSize(t-8,0),this.updateTextPosition(),this}setText(t){return this.textObject.setText(t),this.updateTextPosition(),this}handleDrag(t){t.isDown&&(this.scrollY-=t.velocity.y,this.updateTextPosition())}handleScroll(t,e,i,n,r){this.scrollY+=.5*n,this.updateTextPosition()}updateTextPosition(){const t=Math.max(0,this.textObject.height-this.boxHeight);this.scrollY=i.Math.Clamp(this.scrollY,0,t),this.textObject.y=-this.scrollY;const e=this.scrollY/t,n=this.boxHeight/this.textObject.height;this.scrollbar.height=n*this.boxHeight,this.scrollbar.setPosition(this.textObject.width+4,e*(this.boxHeight-n*this.boxHeight))}}class Ml extends i.Scene{constructor(t){super(t.key),e(this,"dialogData"),e(this,"container"),e(this,"keys"),this.dialogData=t}create(){var t,e;this.container=this.add.container(d.width/2,d.height/2),this.container.add(this.add.rectangle(0,0,.95*d.width,.95*d.height,0,.9).setStrokeStyle(4,I(T.Tan))),this.container.add(new bt(this,.44*d.width,-.4*d.height,"X",(()=>this.close(!1)),{backgroundColor:`#${T.Warning}`})),this.container.add(this.add.text(0,-.4*d.height,this.dialogData.title,{...P,fontSize:48}).setOrigin(.5)),null==(t=this.input.keyboard)||t.on("keydown-ESC",(()=>{this.close(!1)})),null==(e=this.input.keyboard)||e.on("keydown-BACKSPACE",(()=>{this.close(!1)})),this.keys=new C(this),new jl(this,!0).setVisible(this.dialogData.gamepadVisible),this.dialogData.childScene&&this.scene.launch(this.dialogData.childScene,{parent:this})}close(t){var e,i;this.scene.stop(),this.dialogData.childScene&&this.scene.stop(this.dialogData.childScene),this.scene.resume("Game"),null==(i=null==(e=this.scene.get("Game"))?void 0:e.gamepad)||i.setAlpha(1),this.handleSuccess(t)}}const zl=Object.keys(v).map((t=>v[t])).filter((t=>"number"==typeof t)),Ll=Object.keys(k).map((t=>k[t])).filter((t=>"number"==typeof t)),Bl=Object.keys(w).map((t=>w[t])).filter((t=>"number"==typeof t));function Fl(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Dl(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Fl(Object(i),!0).forEach((function(e){Wl(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Fl(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Wl(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Rl(t){return t.slice(0,-1)}function Gl(t,e=0){return e?Array.from(Array(e-t).keys()).map((e=>e+t)):Array.from(Array(t).keys())}function Ul(t){return[...new Set(t)]}function _l(t,e){const i=Ul(t.map((t=>t.set))).filter(Boolean),n=(r=Gl(1,t.length+1),s=i,[r,s].reduce(((t,e)=>t.filter((t=>!e.includes(t)))))).sort((()=>.5-e()));var r,s;t.filter((t=>!t.set)).forEach(((t,e)=>t.set=n[e]))}function Nl(t,e,i=.5){Rl(t).forEach(((n,r)=>{const s=t[r+1],o=n.set!==s.set,a=e()<=i;var l,h,c;o&&a&&(l=t,h=s.set,c=n.set,l.forEach((t=>{t.set===h&&(t.set=c)})),n.right=!1,s.left=!1)}))}const Hl=48;class $l extends i.Scene{constructor(){super("Maze"),e(this,"parent"),e(this,"graphics"),e(this,"keys"),e(this,"maze"),e(this,"mazePlayer"),e(this,"nextUpdate")}init(t){this.parent=t.parent}create(){this.createMaze(),this.mazePlayer=this.add.ellipse(0,0,.8*Hl,.8*Hl,5601177).setSmoothness(32).setOrigin(-.13),this.cameras.main.startFollow(this.mazePlayer),this.keys=this.parent.keys}createMaze(){const t=dt(this.parent.player.scene);this.maze=function(t=8,e=t,i=!0,n=1){const r=function(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}(n),s=[],o=Gl(t);for(let h=0;h<e;h+=1){const n=o.map((n=>({x:n,y:h,top:i||h>0,left:i||n>0,bottom:i||h<e-1,right:i||n<t-1})));s.push(n)}Rl(s).forEach(((t,e)=>{_l(t,r),Nl(t,r),function(t,e,i){const n=Object.values(function(t,e){let i=Ul(t.map((t=>t.set))).reduce(((t,e)=>Dl(Dl({},t),{},{[e]:[]})),{});return t.forEach((t=>i[t.set].push(t))),i}(t)),{ceil:r}=Math;n.forEach((t=>{(function(t,e,i){e=null==e?1:e;const n=null==t?0:t.length;if(!n||e<1)return[];e=e>n?n:e;let r=-1;const s=n-1,o=[...t];for(;++r<e;){const t=r+Math.floor(i()*(s-r+1)),e=o[t];o[t]=o[r],o[r]=e}return o.slice(0,e)})(t,r(i()*t.length),i).forEach((t=>{if(t){const i=e[t.x];t.bottom=!1,i.top=!1,i.set=t.set}}))}))}(t,s[e+1],r)}));const a=(l=s)[l.length-1];var l;return _l(a,r),Nl(a,r,1),s}(24,24,!0,t),this.graphics=this.add.graphics(),this.graphics.fillStyle(10040098,.5),this.graphics.fillRect(1104,1104,Hl,Hl),this.graphics.lineStyle(3,3385907),this.maze.forEach((t=>{t.forEach((t=>{if(t.top){const e=new i.Geom.Line(t.x*Hl,t.y*Hl,t.x*Hl+Hl,t.y*Hl);this.graphics.strokeLineShape(e)}if(t.bottom){const e=new i.Geom.Line(t.x*Hl,t.y*Hl+Hl,t.x*Hl+Hl,t.y*Hl+Hl);this.graphics.strokeLineShape(e)}if(t.left){const e=new i.Geom.Line(t.x*Hl,t.y*Hl,t.x*Hl,t.y*Hl+Hl);this.graphics.strokeLineShape(e)}if(t.right){const e=new i.Geom.Line(t.x*Hl+Hl,t.y*Hl,t.x*Hl+Hl,t.y*Hl+Hl);this.graphics.strokeLineShape(e)}}))})),this.cameras.main.setViewport(50,130,d.width-100,d.height-170)}update(t,e){if(t<this.nextUpdate)return;const n=this.keys.keys,r=new i.Math.Vector2(0,0);n[E.Left]?r.x=-48:n[E.Right]?r.x=Hl:n[E.Up]?r.y=-48:n[E.Down]&&(r.y=Hl);const s=new i.Math.Vector2(this.mazePlayer.x+r.x,this.mazePlayer.y+r.y);if((this.mazePlayer.x!==s.x||this.mazePlayer.y!==s.y)&&this.canMove(s)){this.mazePlayer.setPosition(s.x,s.y);const t=new i.Math.Vector2(1104,1104);this.parent.setAngle(i.Math.Angle.BetweenPoints(s,t)),this.mazePlayer.x===t.x&&this.mazePlayer.y===t.y&&this.parent.close(!0)}this.nextUpdate=t+140}canMove(t){const e=t.x,n=t.y,r=i.Math.FloorTo(e/Hl),s=i.Math.FloorTo(n/Hl);if(r<0||s<0||r>=24||s>=24)return!1;const o=i.Math.FloorTo(this.mazePlayer.x/Hl),a=i.Math.FloorTo(this.mazePlayer.y/Hl),l=this.maze[a][o];return!(l.top&&n<this.mazePlayer.y||l.bottom&&n>this.mazePlayer.y||l.left&&e<this.mazePlayer.x||l.right&&e>this.mazePlayer.x)}}class Vl extends i.Scene{constructor(){super("Paused"),e(this,"parent")}init(t){this.parent=t.game}create(){var t;const{width:e,height:i}=d;this.add.rectangle(e/2,i/2,e,i,0,.75).setInteractive().on("pointerdown",(()=>this.resume())),this.add.text(e/2,100,"Game Paused",{...P,fontSize:72}).setOrigin(.5),this.add.text(e-20,20,`Build Time: ${new Date("2024-08-10T18:48:54.205Z").toLocaleString()}`,{...P,fontSize:16}).setOrigin(1,0);const n=!d.zoomed,r=n?100:80,s=n?48:36,o=n?220:180,a=new vt(this);a.addButton(new bt(this,e/2,o,"Resume",(()=>this.resume()),{fontSize:s})),a.addButton(new bt(this,e/2,o+r,"Save",(()=>{this.resume(),fl(this.parent)}),{fontSize:s})),a.addButton(new bt(this,e/2,o+2*r,"Load",(()=>{this.resume(),this.parent.scene.restart()}),{fontSize:s})),a.addButton(new bt(this,e/2,o+3*r,"Toggle Gamepad",(()=>{this.parent.gamepad.setVisible(!this.parent.gamepad.visible)}),{fontSize:s})),null==(t=this.input.keyboard)||t.on("keydown-ESC",(()=>this.resume())),new jl(this).setVisible(!1)}resume(){this.scene.stop(),this.scene.resume("Game")}}var ql=(t=>(t.Straight="S",t.Corner="C",t.T="T",t.Cross="X",t.Empty=" ",t))(ql||{}),Kl=(t=>(t[t.Up=0]="Up",t[t.Right=90]="Right",t[t.Down=180]="Down",t[t.Left=270]="Left",t))(Kl||{});const Ql={S:[[0,0,0],[1,1,1],[0,0,0]],C:[[0,0,0],[1,1,0],[0,1,0]],T:[[0,0,0],[1,1,1],[0,1,0]],X:[[0,1,0],[1,1,1],[0,1,0]]," ":[[0,0,0],[0,0,0],[0,0,0]]},Yl=[["C"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "],["T","C"," "," "," ","C","C"," ","C","S","T","X"," "," "," "," "],[" ","S"," "," "," ","T","S"," ","X"," "," ","S"," "," "," "," "],[" ","X","S","T"," ","S","S"," ","X"," "," ","X","X","T"," "," "],[" "," "," ","C","X","T","T","X","S"," "," ","T","C","S"," "," "],[" "," "," "," "," "," "," ","X","T"," "," "," "," ","S"," "," "],[" "," "," "," "," "," "," ","S","T"," "," "," "," ","T","S","C"],[" "," "," "," "," "," "," ","C","C"," "," "," "," "," "," ","C"]].map((t=>t.map((t=>t))));function Xl(t,e,i){const n=[],r=new Set,s=t.length,o=t[0].length;return function e(i,a){const l=`${i},${a}`;r.add(l),n.push(t[a][i]),i+1<o&&!r.has(`${i+1},${a}`)&&Jl(t[a][i],t[a][i+1])&&e(i+1,a),i-1>=0&&!r.has(`${i-1},${a}`)&&Jl(t[a][i],t[a][i-1])&&e(i-1,a),a+1<s&&!r.has(`${i},${a+1}`)&&Jl(t[a][i],t[a+1][i])&&e(i,a+1),a-1>=0&&!r.has(`${i},${a-1}`)&&Jl(t[a][i],t[a-1][i])&&e(i,a-1)}(e,i),n}function Jl(t,e){if(!t||!e)return!1;const i=Zl(t),n=Zl(e),r=e.x-t.x,s=e.y-t.y;return 1===r&&0===s?i.right&&n.left:-1===r&&0===s?i.left&&n.right:0===r&&1===s?i.bottom&&n.top:0===r&&-1===s&&i.top&&n.bottom}function Zl(t){const e=function(t){let e=Ql[t.type];const i=Math.floor(t.rotation/90);for(let n=0;n<i;n++)e=th(e);return e}(t);return{left:e.some((t=>1===t[0])),right:e.some((t=>1===t[t.length-1])),top:e[0].some((t=>1===t)),bottom:e[e.length-1].some((t=>1===t))}}function th(t){return t[0].map(((e,i)=>t.map((t=>t[i])).reverse()))}class eh extends i.Scene{constructor(){super("Pipes"),e(this,"parent"),e(this,"graphics"),e(this,"cursor"),e(this,"position"),e(this,"keys"),e(this,"pipes",[]),e(this,"images"),e(this,"blockSize"),e(this,"pipeSize"),e(this,"nextUpdate",0),e(this,"initialized",!1)}init(t){this.parent=t.parent,this.blockSize=d.zoomed?13:17,this.pipeSize=3.75*this.blockSize}preload(){this.prerenderPipes()}prerenderPipes(){for(const t of Object.values(ql).filter((t=>"number"!=typeof t))){const e=Ql[t],i=`pipe_${t}`;this.textures.exists(i)&&this.textures.remove(i);const n=this.textures.createCanvas(i,3*this.blockSize,3*this.blockSize);if(n){const t=n.context;t.fillStyle="#ffffff";for(let i=0;i<e.length;i++)for(let n=0;n<e[i].length;n++)1===e[i][n]&&t.fillRect(n*this.blockSize,i*this.blockSize,this.blockSize,this.blockSize);n.refresh()}}}create(){this.graphics=this.add.graphics(),this.keys=this.parent.keys,this.cursor=this.add.rectangle(100,100,this.pipeSize,this.pipeSize,0,0).setStrokeStyle(2,I(T.Tan),.75).setVisible(!1),this.position=new i.Math.Vector2(0,0),this.createPipes()}createPipes(){this.pipes=[],this.images=this.add.container().setPosition(d.width/2-16*this.pipeSize/2+this.pipeSize/2,d.height/4);for(let n=0;n<8;n++){this.pipes[n]||(this.pipes[n]=[]);for(let e=0;e<16;e++){let r=Yl[n][e];const s=0===e&&0===n,o=15===e&&7===n;let a=!s&&!o;r===ql.Empty&&Math.random()<.9&&(r=(t=Object.values(ql).filter((t=>"number"!=typeof t)))[Math.floor(Math.random()*t.length)],r===ql.Cross&&Math.random()<.5&&(r=ql.T),Math.random()<.25&&(a=!1)),this.pipes[n][e]={x:e,y:n,type:r,rotation:90*i.Math.Between(0,3),interactive:a},s&&(this.pipes[n][e].rotation=Kl.Up),o&&(this.pipes[n][e].rotation=Kl.Down)}}var t;const e=Xl(this.pipes,0,0);for(let i=0;i<8;i++)for(let t=0;t<16;t++){const n=t+i*Yl[0].length,r=this.pipes[i][t];this.time.delayedCall(50+5*n,(()=>{const n=`pipe_${r.type}`,s=this.add.image(t*this.pipeSize,i*this.pipeSize,n).on("pointerdown",(()=>{this.initialized&&(this.cursor.setVisible(!1),this.pipes[i][t].rotation=(this.pipes[i][t].rotation+90)%360,this.updatePipes())})),o=15===t&&7===i;s.setAlpha(0).setScale(.5).setAngle(this.pipes[i][t].rotation),this.tweens.add({targets:s,alpha:1,scale:1,duration:300,onComplete:o?()=>{this.initialized=!0,this.updatePipes()}:void 0}),r.interactive?s.setInteractive():s.setTint(6710886),e.includes(r)&&(r.interactive?s.setTint(3364249):s.setTint(8789)),this.images.add(s)}))}}updatePipes(){const t=Xl(this.pipes,0,0);this.pipes.forEach((e=>{e.forEach((e=>{const i=this.images.getAt(e.x+e.y*Yl[0].length);i.setAngle(e.rotation),t.includes(e)?(e.interactive?i.setTint(3364249):i.setTint(8789),e.x===Yl[0].length-1&&e.y===Yl.length-1&&this.parent.time.delayedCall(500,(()=>{this.parent.close(!0)}))):e.interactive?i.setTint(16777215):i.setTint(6710886)}))}))}update(t,e){if(this.initialized&&t<this.nextUpdate)return;let i=!0;const n=this.keys.keys;if(n[E.Continue]){const t=this.pipes[this.position.y][this.position.x];t.interactive&&(t.rotation=(t.rotation+90)%360,this.updatePipes())}else n[E.Left]?this.position.x=Math.max(0,this.position.x-1):n[E.Right]?this.position.x=Math.min(15,this.position.x+1):n[E.Up]?this.position.y=Math.max(0,this.position.y-1):n[E.Down]?this.position.y=Math.min(7,this.position.y+1):i=!1;i&&(this.nextUpdate=t+170,this.cursor.setVisible(!0),this.cursor.setPosition(this.images.x+this.position.x*this.pipeSize,this.images.y+this.position.y*this.pipeSize))}}!function(t={}){const{immediate:e=!1,onNeedRefresh:i,onOfflineReady:n,onRegistered:r,onRegisteredSW:s,onRegisterError:a}=t;let l,h;h=async function(){if("serviceWorker"in navigator){if(l=await function(t,e,i){let n=Promise.resolve();if(e&&e.length>0){const t=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),s=(null==r?void 0:r.nonce)||(null==r?void 0:r.getAttribute("nonce"));n=Promise.all(e.map((e=>{if(e=function(t,e){return new URL(t,e).href}(e,i),e in o)return;o[e]=!0;const n=e.endsWith(".css"),r=n?'[rel="stylesheet"]':"";if(i)for(let i=t.length-1;i>=0;i--){const r=t[i];if(r.href===e&&(!n||"stylesheet"===r.rel))return}else if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=n?"stylesheet":"modulepreload",n||(a.as="script",a.crossOrigin=""),a.href=e,s&&a.setAttribute("nonce",s),document.head.appendChild(a),n?new Promise(((t,i)=>{a.addEventListener("load",t),a.addEventListener("error",(()=>i(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}return n.then((()=>t())).catch((t=>{const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=t,window.dispatchEvent(e),!e.defaultPrevented)throw t}))}((()=>import("./workbox-window.prod.es5-B8JjyKVo.js")),[],import.meta.url).then((({Workbox:t})=>new t("./sw.js",{scope:"./",type:"classic"}))).catch((t=>{null==a||a(t)})),!l)return;l.addEventListener("activated",(t=>{(t.isUpdate||t.isExternal)&&window.location.reload()})),l.addEventListener("installed",(t=>{t.isUpdate||null==n||n()})),l.register({immediate:e}).then((t=>{s?s("./sw.js",t):null==r||r(t)})).catch((t=>{null==a||a(t)}))}}()}({immediate:!0});const ih={type:Phaser.AUTO,width:d.width,height:d.height,parent:"game-container",backgroundColor:I(T.Background),scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[y,El,Al,Vl,class extends Ml{constructor(){super({key:"JournalDialog",title:"Journal",gamepadVisible:!1}),e(this,"player")}init(t){this.player=t.player}create(){var t;super.create();const e=this.player.journal.journal.map((t=>`- ${X[t].description}\n`)).reverse();new Cl(this,.08*d.width,.25*d.height,e,{fontSize:32}).setBoxSize(.84*d.width,.62*d.height),null==(t=this.input.keyboard)||t.on("keydown-J",(()=>{this.close()}))}handleSuccess(){}},class extends Ml{constructor(){super({key:"MazeDialog",title:"Find your way through the forest",childScene:"Maze",gamepadVisible:!0}),e(this,"player"),e(this,"arrow")}init(t){this.player=t.player,this.dialogData.gamepadVisible=t.player.scene.gamepad.visible}create(){super.create(),this.arrow=this.add.image(.4*-d.width,.4*-d.height,"arrow").setScale(.5).setRotation(.75*Math.PI),this.container.add(this.arrow)}setAngle(t){this.arrow.setRotation(t+Math.PI/2)}handleSuccess(t){t?(nt(b.Forest,this.player),this.player.journal.addEntry(k.ForestMazeSolved)):this.player.setPosition(tt[b.TownEast].x-40,tt[b.TownEast].y)}},$l,class extends Ml{constructor(){super({key:"PipesDialog",title:"Rotate the pipes to fix the alchemy set",gamepadVisible:!1,childScene:"Pipes"}),e(this,"player")}init(t){this.player=t.player}handleSuccess(t){t&&(this.player.message.setDialog({messages:["There. It looks like the alchemy set is properly fit back together."]},ut(this.player.scene,j.AlchemySet),"player_portrait"),this.player.journal.addEntry(k.AlchemySetFixed))}},eh,class extends Ml{constructor(){super({key:"DebugTool",title:"Debug Tool",gamepadVisible:!1}),e(this,"player"),e(this,"tabs",[]),e(this,"tab",3),e(this,"textBox"),e(this,"helperText"),e(this,"saveContainer")}init(t){this.player=t.player}create(){super.create();const t=this.makeTab("Items",0),e=this.makeTab("Journal",1),i=this.makeTab("Quests",2),n=this.makeTab("Saves",3);this.helperText=this.add.text(.94*d.width,110,"",{...P,fontSize:24}).setOrigin(1,0).setDepth(1),this.textBox=new Cl(this,300,100,"",{backgroundColor:"#123",fontSize:32},(t=>this.handleLineClick(t))).setBoxSize(.65*d.width,.75*d.height),this.tabs=[t,e,i,n],this.container.add(this.tabs);const r=new bt(this,40-this.container.x,d.height/2-100,"Debug Mode",(()=>{d.debug=!d.debug,this.close()}),{align:"center"}).setOrigin(0).setFixedSize(250,70);this.container.add(r),this.saveContainer=this.add.container(0,0),Object.entries(Mt).forEach(((t,e)=>{const[i,n]=t,r=new bt(this,310,100+80*e,Et[Number(i)],(()=>{fl(this.player.scene,n),this.close(!0)}),{align:"center"}).setOrigin(0).setFixedSize(250,70);this.saveContainer.add(r)})),this.updateTabs()}makeTab(t,e){return new bt(this,40-this.container.x,100-this.container.y+80*e,t,(()=>{this.tab=e,this.updateTabs()}),{align:"center"}).setOrigin(0).setFixedSize(250,70)}handleLineClick(t){switch(this.tab){case 0:const e=zl[t],i=this.player.inventory.inventory,n=i.find((t=>t.type===e));n?n.used?i.splice(i.indexOf(n),1):n.used=!n.used:this.player.inventory.addItem({type:e,used:!1},!0);break;case 1:const r=Ll[t],s=this.player.journal.journal;lt(s,r)?s.splice(s.indexOf(r),1):this.player.journal.addEntry(r,!0);break;case 2:const o=Bl[t],a=this.player.quests.quests,l=a.find((t=>t.id===o));l?l.completed?a.splice(a.indexOf(l),1):l.completed=!l.completed:this.player.quests.addQuest({id:o,completed:!1},!0)}this.updateTabs()}updateTabs(){var t;this.tabs.forEach(((t,e)=>{t.setBackgroundColor(e===this.tab?"#123":"#151515")})),null==(t=this.saveContainer)||t.setVisible(3===this.tab),this.textBox.setVisible(3!==this.tab),this.helperText.setVisible(3!==this.tab);let e="";switch(this.tab){case 0:const t=this.player.inventory.inventory;e=zl.map((e=>`[${function(t,e){return void 0!==t.find((t=>t.type===e&&!t.used))}(t,e)?"-":st(t,e)?"x":" "}] ${v[e]}`)).join("\n"),this.helperText.setText("[-] item held\n[x] item used");break;case 1:const i=this.player.journal.journal;e=Ll.map((t=>`[${lt(i,t)?"x":" "}] ${k[t]}`)).join("\n"),this.helperText.setText("");break;case 2:const n=this.player.quests.quests;e=Bl.map((t=>`[${ot(n,t)?"-":at(n,t)?"x":" "}] ${w[t]}`)).join("\n"),this.helperText.setText("[-] quest active\n[x] quest complete")}this.textBox.setText(e)}handleSuccess(t){t||fl(this.player.scene),this.player.scene.scene.restart()}}],input:{gamepad:!0},physics:{default:"arcade"},render:{pixelArt:!0,antialias:!1},dom:{createContainer:!0}};("m6x11","./m6x11.ttf",new FontFace("m6x11","url(./m6x11.ttf)").load().then((function(t){document.fonts.add(t)})).catch((function(t){return t}))).then((()=>{new i.Game(ih)}));
